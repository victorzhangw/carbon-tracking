# 人才評鑑系統資料庫設計文件

## 文件說明

本文件根據「綜合人才洞察評鑑特質分析與多向度洞察報告」倒推資料庫表格結構設計。

---

## 1. 受測者基本資料表 (test_takers)

### 表格說明

儲存受測者的基本個人資訊

### 欄位定義

| 欄位名稱      | 資料型態  | 說明             | 約束條件                  | 範例                    |
| ------------- | --------- | ---------------- | ------------------------- | ----------------------- |
| id            | TEXT      | 受測者唯一識別碼 | PRIMARY KEY               | uuid                    |
| name          | TEXT      | 受測者姓名       | NOT NULL                  | Howard                  |
| email         | TEXT      | 電子信箱         | NOT NULL, UNIQUE          | tank_howard@hotmail.com |
| job_role      | TEXT      | 職務角色         | NULL                      | 專案經理                |
| identity_type | TEXT      | 身份別           | NULL                      | 在職                    |
| created_at    | TIMESTAMP | 建立時間         | DEFAULT CURRENT_TIMESTAMP | 2025-09-02 10:00:00     |
| updated_at    | TIMESTAMP | 更新時間         | DEFAULT CURRENT_TIMESTAMP | 2025-09-03 21:00:00     |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS test_takers (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    email TEXT NOT NULL UNIQUE,
    job_role TEXT,
    identity_type TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 2. 評鑑項目表 (assessment_items)

### 表格說明

定義系統支援的評鑑項目類型

### 欄位定義

| 欄位名稱    | 資料型態  | 說明               | 約束條件                  | 範例                                  |
| ----------- | --------- | ------------------ | ------------------------- | ------------------------------------- |
| id          | TEXT      | 評鑑項目唯一識別碼 | PRIMARY KEY               | uuid                                  |
| code        | TEXT      | 評鑑項目代碼       | NOT NULL, UNIQUE          | CIA                                   |
| name_zh     | TEXT      | 評鑑項目中文名稱   | NOT NULL                  | 綜合人才洞察評鑑                      |
| name_en     | TEXT      | 評鑑項目英文名稱   | NULL                      | Comprehensive Insight Assessment      |
| description | TEXT      | 評鑑項目說明       | NULL                      | 以心理學、行為科學等學理背景為基礎... |
| is_active   | BOOLEAN   | 是否啟用           | DEFAULT 1                 | 1                                     |
| created_at  | TIMESTAMP | 建立時間           | DEFAULT CURRENT_TIMESTAMP | 2025-01-01 00:00:00                   |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS assessment_items (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    name_en TEXT,
    description TEXT,
    is_active BOOLEAN DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 3. 評鑑記錄表 (assessment_records)

### 表格說明

儲存每次評鑑的基本記錄資訊

### 欄位定義

| 欄位名稱           | 資料型態  | 說明               | 約束條件                  | 範例                |
| ------------------ | --------- | ------------------ | ------------------------- | ------------------- |
| id                 | TEXT      | 評鑑記錄唯一識別碼 | PRIMARY KEY               | uuid                |
| test_taker_id      | TEXT      | 受測者 ID          | NOT NULL, FOREIGN KEY     | uuid                |
| assessment_item_id | TEXT      | 評鑑項目 ID        | NOT NULL, FOREIGN KEY     | uuid                |
| invited_at         | TIMESTAMP | 邀請時間           | NULL                      | 2025-09-02 10:00:00 |
| completed_at       | TIMESTAMP | 完成時間           | NULL                      | 2025-09-03 21:00:00 |
| status             | TEXT      | 評鑑狀態           | DEFAULT 'pending'         | completed           |
| created_at         | TIMESTAMP | 建立時間           | DEFAULT CURRENT_TIMESTAMP | 2025-09-02 10:00:00 |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS assessment_records (
    id TEXT PRIMARY KEY,
    test_taker_id TEXT NOT NULL,
    assessment_item_id TEXT NOT NULL,
    invited_at TIMESTAMP,
    completed_at TIMESTAMP,
    status TEXT DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (test_taker_id) REFERENCES test_takers (id) ON DELETE CASCADE,
    FOREIGN KEY (assessment_item_id) REFERENCES assessment_items (id) ON DELETE CASCADE
);
```

---

## 4. 特質定義表 (trait_definitions)

### 表格說明

定義系統中所有可評估的特質項目

### 欄位定義

| 欄位名稱        | 資料型態  | 說明           | 約束條件                  | 範例                        |
| --------------- | --------- | -------------- | ------------------------- | --------------------------- |
| id              | TEXT      | 特質唯一識別碼 | PRIMARY KEY               | uuid                        |
| code            | TEXT      | 特質代碼       | NOT NULL, UNIQUE          | personal_growth_motivation  |
| name_zh         | TEXT      | 特質中文名稱   | NOT NULL                  | 個人成長動機                |
| name_en         | TEXT      | 特質英文名稱   | NULL                      | Personal Growth Motivation  |
| high_score_desc | TEXT      | 高分者描述     | NULL                      | 積極主動尋求自我提升機會... |
| low_score_desc  | TEXT      | 低分者描述     | NULL                      | 較少主動尋求成長機會...     |
| additional_info | TEXT      | 額外說明資訊   | NULL                      | 源於人際心理學...           |
| category        | TEXT      | 特質分類       | NULL                      | key_trait                   |
| created_at      | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP | 2025-01-01 00:00:00         |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS trait_definitions (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    name_en TEXT,
    high_score_desc TEXT,
    low_score_desc TEXT,
    additional_info TEXT,
    category TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 5. 特質分數表 (trait_scores)

### 表格說明

儲存受測者在各個特質上的評分結果

### 欄位定義

| 欄位名稱             | 資料型態  | 說明           | 約束條件                                      | 範例                |
| -------------------- | --------- | -------------- | --------------------------------------------- | ------------------- |
| id                   | TEXT      | 記錄唯一識別碼 | PRIMARY KEY                                   | uuid                |
| assessment_record_id | TEXT      | 評鑑記錄 ID    | NOT NULL, FOREIGN KEY                         | uuid                |
| trait_id             | TEXT      | 特質 ID        | NOT NULL, FOREIGN KEY                         | uuid                |
| score                | INTEGER   | 特質分數       | NOT NULL, CHECK (score >= 0 AND score <= 100) | 88                  |
| created_at           | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP                     | 2025-09-03 21:00:00 |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS trait_scores (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    trait_id TEXT NOT NULL,
    score INTEGER NOT NULL CHECK (score >= 0 AND score <= 100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (trait_id) REFERENCES trait_definitions (id) ON DELETE CASCADE
);
```

---

## 6. 向度定義表 (dimension_definitions)

### 表格說明

定義特質向度的分類架構

### 欄位定義

| 欄位名稱      | 資料型態  | 說明           | 約束條件                  | 範例                          |
| ------------- | --------- | -------------- | ------------------------- | ----------------------------- |
| id            | TEXT      | 向度唯一識別碼 | PRIMARY KEY               | uuid                          |
| code          | TEXT      | 向度代碼       | NOT NULL, UNIQUE          | integrity_trustworthiness     |
| name_zh       | TEXT      | 向度中文名稱   | NOT NULL                  | 品格誠信素養                  |
| name_en       | TEXT      | 向度英文名稱   | NULL                      | Integrity and Trustworthiness |
| description   | TEXT      | 向度說明       | NULL                      | 信任，是合作的基礎...         |
| display_order | INTEGER   | 顯示順序       | DEFAULT 0                 | 1                             |
| created_at    | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP | 2025-01-01 00:00:00           |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS dimension_definitions (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    name_en TEXT,
    description TEXT,
    display_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 7. 向度分數表 (dimension_scores)

### 表格說明

儲存受測者在各個向度上的綜合評分

### 欄位定義

| 欄位名稱             | 資料型態  | 說明           | 約束條件                                      | 範例                |
| -------------------- | --------- | -------------- | --------------------------------------------- | ------------------- |
| id                   | TEXT      | 記錄唯一識別碼 | PRIMARY KEY                                   | uuid                |
| assessment_record_id | TEXT      | 評鑑記錄 ID    | NOT NULL, FOREIGN KEY                         | uuid                |
| dimension_id         | TEXT      | 向度 ID        | NOT NULL, FOREIGN KEY                         | uuid                |
| score                | INTEGER   | 向度分數       | NOT NULL, CHECK (score >= 0 AND score <= 100) | 72                  |
| created_at           | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP                     | 2025-09-03 21:00:00 |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS dimension_scores (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    dimension_id TEXT NOT NULL,
    score INTEGER NOT NULL CHECK (score >= 0 AND score <= 100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE
);
```

---

## 8. 特質向度關聯表 (trait_dimension_mapping)

### 表格說明

定義特質與向度之間的對應關係

### 欄位定義

| 欄位名稱     | 資料型態  | 說明           | 約束條件                  | 範例                |
| ------------ | --------- | -------------- | ------------------------- | ------------------- |
| id           | TEXT      | 記錄唯一識別碼 | PRIMARY KEY               | uuid                |
| trait_id     | TEXT      | 特質 ID        | NOT NULL, FOREIGN KEY     | uuid                |
| dimension_id | TEXT      | 向度 ID        | NOT NULL, FOREIGN KEY     | uuid                |
| weight       | REAL      | 權重係數       | DEFAULT 1.0               | 1.0                 |
| created_at   | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP | 2025-01-01 00:00:00 |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS trait_dimension_mapping (
    id TEXT PRIMARY KEY,
    trait_id TEXT NOT NULL,
    dimension_id TEXT NOT NULL,
    weight REAL DEFAULT 1.0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (trait_id) REFERENCES trait_definitions (id) ON DELETE CASCADE,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE,
    UNIQUE(trait_id, dimension_id)
);
```

---

## 9. 標籤定義表 (tag_definitions)

### 表格說明

定義報告中使用的標籤（如 #溝通透明、#虛心謙遜 等）

### 欄位定義

| 欄位名稱   | 資料型態  | 說明           | 約束條件                  | 範例                       |
| ---------- | --------- | -------------- | ------------------------- | -------------------------- |
| id         | TEXT      | 標籤唯一識別碼 | PRIMARY KEY               | uuid                       |
| code       | TEXT      | 標籤代碼       | NOT NULL, UNIQUE          | communication_transparency |
| name_zh    | TEXT      | 標籤中文名稱   | NOT NULL                  | 溝通透明                   |
| tag_type   | TEXT      | 標籤類型       | NOT NULL                  | strength/weakness          |
| created_at | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP | 2025-01-01 00:00:00        |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS tag_definitions (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    tag_type TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 10. 向度標籤關聯表 (dimension_tags)

### 表格說明

記錄評鑑結果中向度與標籤的關聯

### 欄位定義

| 欄位名稱             | 資料型態  | 說明           | 約束條件                  | 範例                |
| -------------------- | --------- | -------------- | ------------------------- | ------------------- |
| id                   | TEXT      | 記錄唯一識別碼 | PRIMARY KEY               | uuid                |
| assessment_record_id | TEXT      | 評鑑記錄 ID    | NOT NULL, FOREIGN KEY     | uuid                |
| dimension_id         | TEXT      | 向度 ID        | NOT NULL, FOREIGN KEY     | uuid                |
| tag_id               | TEXT      | 標籤 ID        | NOT NULL, FOREIGN KEY     | uuid                |
| created_at           | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP | 2025-09-03 21:00:00 |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS dimension_tags (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    dimension_id TEXT NOT NULL,
    tag_id TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE,
    FOREIGN KEY (tag_id) REFERENCES tag_definitions (id) ON DELETE CASCADE
);
```

---

## 11. 面試問題庫表 (interview_questions)

### 表格說明

儲存結構化面試問題

### 欄位定義

| 欄位名稱      | 資料型態  | 說明           | 約束條件                  | 範例                                            |
| ------------- | --------- | -------------- | ------------------------- | ----------------------------------------------- |
| id            | TEXT      | 問題唯一識別碼 | PRIMARY KEY               | uuid                                            |
| dimension_id  | TEXT      | 關聯向度 ID    | NOT NULL, FOREIGN KEY     | uuid                                            |
| question_text | TEXT      | 問題內容       | NOT NULL                  | 請描述一次你在工作中面臨道德或倫理兩難的情況... |
| question_type | TEXT      | 問題類型       | NOT NULL                  | strength/weakness                               |
| display_order | INTEGER   | 顯示順序       | DEFAULT 0                 | 1                                               |
| created_at    | TIMESTAMP | 建立時間       | DEFAULT CURRENT_TIMESTAMP | 2025-01-01 00:00:00                             |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS interview_questions (
    id TEXT PRIMARY KEY,
    dimension_id TEXT NOT NULL,
    question_text TEXT NOT NULL,
    question_type TEXT NOT NULL,
    display_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE
);
```

---

## 12. 綜合分析表 (comprehensive_analysis)

### 表格說明

儲存評鑑報告的綜合分析結果

### 欄位定義

| 欄位名稱              | 資料型態  | 說明               | 約束條件                  | 範例                          |
| --------------------- | --------- | ------------------ | ------------------------- | ----------------------------- |
| id                    | TEXT      | 分析記錄唯一識別碼 | PRIMARY KEY               | uuid                          |
| assessment_record_id  | TEXT      | 評鑑記錄 ID        | NOT NULL, FOREIGN KEY     | uuid                          |
| strength_dimension_id | TEXT      | 優勢向度 ID        | NULL, FOREIGN KEY         | uuid                          |
| strength_description  | TEXT      | 優勢描述           | NULL                      | 在工作中誠實面對問題和挑戰... |
| weakness_dimension_id | TEXT      | 劣勢向度 ID        | NULL, FOREIGN KEY         | uuid                          |
| weakness_description  | TEXT      | 劣勢描述           | NULL                      | 經常將個人目標置於團隊之上... |
| created_at            | TIMESTAMP | 建立時間           | DEFAULT CURRENT_TIMESTAMP | 2025-09-03 21:00:00           |

### SQL 建表語句

```sql
CREATE TABLE IF NOT EXISTS comprehensive_analysis (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    strength_dimension_id TEXT,
    strength_description TEXT,
    weakness_dimension_id TEXT,
    weakness_description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (strength_dimension_id) REFERENCES dimension_definitions (id),
    FOREIGN KEY (weakness_dimension_id) REFERENCES dimension_definitions (id)
);
```

---

## 資料庫關聯圖 (ER Diagram)

```
test_takers (受測者)
    ↓ 1:N
assessment_records (評鑑記錄)
    ↓ 1:N                    ↓ 1:N
trait_scores (特質分數)    dimension_scores (向度分數)
    ↓ N:1                    ↓ N:1
trait_definitions (特質)   dimension_definitions (向度)
    ↓ N:M                    ↓ 1:N
trait_dimension_mapping    interview_questions (面試問題)
    ↓ N:1
dimension_definitions (向度)

assessment_records
    ↓ 1:N
dimension_tags (向度標籤)
    ↓ N:1
tag_definitions (標籤定義)

assessment_records
    ↓ 1:1
comprehensive_analysis (綜合分析)
```

---

## 資料範例

### 特質定義範例資料

```sql
-- 個人成長動機
INSERT INTO trait_definitions (id, code, name_zh, name_en, high_score_desc, low_score_desc, category)
VALUES (
    'trait_001',
    'personal_growth_motivation',
    '個人成長動機',
    'Personal Growth Motivation',
    '積極主動尋求自我提升機會，對個人發展具備明確願景和行動力。',
    '較少主動尋求成長機會，對自我發展缺乏明確規劃和執行動力。',
    'key_trait'
);

-- 同理心
INSERT INTO trait_definitions (id, code, name_zh, name_en, high_score_desc, low_score_desc, additional_info, category)
VALUES (
    'trait_004',
    'empathy',
    '同理心',
    'Empathy',
    '能站在他人角度思考問題，敏銳察覺他人情緒變化，在人際互動中展現體貼關懷',
    '較難理解他人感受，容易以自己的角度判斷事情，在人際關係中較為疏離',
    '源於人際心理學，是理解與感受他人情緒的能力。它在企業中能促進團隊合作、提升顧客體驗，並加強領導力...',
    'key_trait'
);
```

### 向度定義範例資料

```sql
-- 品格誠信素養
INSERT INTO dimension_definitions (id, code, name_zh, name_en, description, display_order)
VALUES (
    'dim_001',
    'integrity_trustworthiness',
    '品格誠信素養',
    'Integrity and Trustworthiness',
    '信任，是合作的基礎，品格，是組織的延伸。此面向能幫助判斷候選人是否誠實可信、價值觀健康。',
    1
);

-- 核心工作動能
INSERT INTO dimension_definitions (id, code, name_zh, name_en, description, display_order)
VALUES (
    'dim_002',
    'core_work_drive',
    '核心工作動能',
    'Core Work Drive',
    '此面向反映一個人在職場上的穩定性、執行力與自驅力。',
    2
);

-- 成長創新驅動力
INSERT INTO dimension_definitions (id, code, name_zh, name_en, description, display_order)
VALUES (
    'dim_003',
    'growth_innovation_drive',
    '成長創新驅動力',
    'Growth & Innovation Drive',
    '持續進化的人，才跟得上變動的世界。此面向反映個人的未來潛力與變革適應能力。',
    3
);

-- 團隊協作與互動能力
INSERT INTO dimension_definitions (id, code, name_zh, name_en, description, display_order)
VALUES (
    'dim_004',
    'team_collaboration_interpersonal_agility',
    '團隊協作與互動能力',
    'Team Collaboration & Interpersonal Agility',
    '能獨立是能力，願共事是價值。此面向評估一個人在人際互動與團隊合作中的成熟度與適應力。',
    4
);
```

### 標籤定義範例資料

```sql
-- 優勢標籤
INSERT INTO tag_definitions (id, code, name_zh, tag_type)
VALUES
    ('tag_001', 'communication_transparency', '溝通透明', 'strength'),
    ('tag_002', 'humble_modest', '虛心謙遜', 'strength'),
    ('tag_003', 'group_interest_consideration', '群體利益考量', 'strength'),
    ('tag_004', 'recognize_others', '認同他人', 'strength'),
    ('tag_005', 'words_actions_consistent', '言行合一', 'strength'),
    ('tag_006', 'express_gratitude', '表達感恩', 'strength');

-- 劣勢標籤
INSERT INTO tag_definitions (id, code, name_zh, tag_type)
VALUES
    ('tag_007', 'individual_oriented', '個人本位', 'weakness'),
    ('tag_008', 'difficulty_understanding_others', '難理解他人', 'weakness'),
    ('tag_009', 'relationship_distant', '關係疏離', 'weakness'),
    ('tag_010', 'conflict_avoidance', '衝突迴避', 'weakness'),
    ('tag_011', 'adaptation_difficulty', '適應困難', 'weakness'),
    ('tag_012', 'unwilling_to_share', '不願分享', 'weakness');
```

### 面試問題範例資料

```sql
-- 品格誠信素養 - 優勢面向問題
INSERT INTO interview_questions (id, dimension_id, question_text, question_type, display_order)
VALUES
    ('q_001', 'dim_001', '請描述一次你在工作中面臨道德或倫理兩難的情況，你是如何處理的？', 'strength', 1),
    ('q_002', 'dim_001', '當你在工作中犯錯時，你通常會如何處理？可以舉一個具體例子嗎？', 'strength', 2),
    ('q_003', 'dim_001', '如果你發現同事或主管的決定對其他人不公平，你會如何應對？', 'strength', 3),
    ('q_004', 'dim_001', '請分享一次你主動感謝或表彰他人貢獻的經驗。', 'strength', 4),
    ('q_005', 'dim_001', '在團隊合作中，當你的個人利益與團隊利益發生衝突時，你會怎麼做？', 'strength', 5);

-- 團隊協作與互動能力 - 劣勢面向問題
INSERT INTO interview_questions (id, dimension_id, question_text, question_type, display_order)
VALUES
    ('q_006', 'dim_004', '請描述一次你幫助團隊成員解決困難的經驗，你是如何提供協助的？', 'weakness', 1),
    ('q_007', 'dim_004', '當團隊中出現意見分歧或衝突時，你通常扮演什麼角色？請舉例說明。', 'weakness', 2),
    ('q_008', 'dim_004', '請分享一次你需要與工作風格或個性與你很不同的人合作的經驗。', 'weakness', 3),
    ('q_009', 'dim_004', '如果你發現團隊成員情緒低落或遇到困難，你會如何回應？', 'weakness', 4);
```

---

## 完整資料庫初始化腳本

### 建立所有表格

```sql
-- 1. 受測者基本資料表
CREATE TABLE IF NOT EXISTS test_takers (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    email TEXT NOT NULL UNIQUE,
    job_role TEXT,
    identity_type TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 2. 評鑑項目表
CREATE TABLE IF NOT EXISTS assessment_items (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    name_en TEXT,
    description TEXT,
    is_active BOOLEAN DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 3. 評鑑記錄表
CREATE TABLE IF NOT EXISTS assessment_records (
    id TEXT PRIMARY KEY,
    test_taker_id TEXT NOT NULL,
    assessment_item_id TEXT NOT NULL,
    invited_at TIMESTAMP,
    completed_at TIMESTAMP,
    status TEXT DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (test_taker_id) REFERENCES test_takers (id) ON DELETE CASCADE,
    FOREIGN KEY (assessment_item_id) REFERENCES assessment_items (id) ON DELETE CASCADE
);

-- 4. 特質定義表
CREATE TABLE IF NOT EXISTS trait_definitions (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    name_en TEXT,
    high_score_desc TEXT,
    low_score_desc TEXT,
    additional_info TEXT,
    category TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 5. 特質分數表
CREATE TABLE IF NOT EXISTS trait_scores (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    trait_id TEXT NOT NULL,
    score INTEGER NOT NULL CHECK (score >= 0 AND score <= 100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (trait_id) REFERENCES trait_definitions (id) ON DELETE CASCADE
);

-- 6. 向度定義表
CREATE TABLE IF NOT EXISTS dimension_definitions (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    name_en TEXT,
    description TEXT,
    display_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 7. 向度分數表
CREATE TABLE IF NOT EXISTS dimension_scores (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    dimension_id TEXT NOT NULL,
    score INTEGER NOT NULL CHECK (score >= 0 AND score <= 100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE
);

-- 8. 特質向度關聯表
CREATE TABLE IF NOT EXISTS trait_dimension_mapping (
    id TEXT PRIMARY KEY,
    trait_id TEXT NOT NULL,
    dimension_id TEXT NOT NULL,
    weight REAL DEFAULT 1.0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (trait_id) REFERENCES trait_definitions (id) ON DELETE CASCADE,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE,
    UNIQUE(trait_id, dimension_id)
);

-- 9. 標籤定義表
CREATE TABLE IF NOT EXISTS tag_definitions (
    id TEXT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    name_zh TEXT NOT NULL,
    tag_type TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 10. 向度標籤關聯表
CREATE TABLE IF NOT EXISTS dimension_tags (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    dimension_id TEXT NOT NULL,
    tag_id TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE,
    FOREIGN KEY (tag_id) REFERENCES tag_definitions (id) ON DELETE CASCADE
);

-- 11. 面試問題庫表
CREATE TABLE IF NOT EXISTS interview_questions (
    id TEXT PRIMARY KEY,
    dimension_id TEXT NOT NULL,
    question_text TEXT NOT NULL,
    question_type TEXT NOT NULL,
    display_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (dimension_id) REFERENCES dimension_definitions (id) ON DELETE CASCADE
);

-- 12. 綜合分析表
CREATE TABLE IF NOT EXISTS comprehensive_analysis (
    id TEXT PRIMARY KEY,
    assessment_record_id TEXT NOT NULL,
    strength_dimension_id TEXT,
    strength_description TEXT,
    weakness_dimension_id TEXT,
    weakness_description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_record_id) REFERENCES assessment_records (id) ON DELETE CASCADE,
    FOREIGN KEY (strength_dimension_id) REFERENCES dimension_definitions (id),
    FOREIGN KEY (weakness_dimension_id) REFERENCES dimension_definitions (id)
);
```

---

## 查詢範例

### 1. 查詢受測者的完整評鑑報告

```sql
SELECT
    tt.name AS 受測者姓名,
    tt.email AS 電子信箱,
    tt.job_role AS 職務角色,
    ai.name_zh AS 測驗項目,
    ar.invited_at AS 邀請時間,
    ar.completed_at AS 結果取得時間
FROM assessment_records ar
JOIN test_takers tt ON ar.test_taker_id = tt.id
JOIN assessment_items ai ON ar.assessment_item_id = ai.id
WHERE tt.email = 'tank_howard@hotmail.com';
```

### 2. 查詢受測者的所有特質分數

```sql
SELECT
    td.name_zh AS 特質名稱,
    ts.score AS 分數,
    td.high_score_desc AS 高分描述,
    td.low_score_desc AS 低分描述
FROM trait_scores ts
JOIN trait_definitions td ON ts.trait_id = td.id
JOIN assessment_records ar ON ts.assessment_record_id = ar.id
JOIN test_takers tt ON ar.test_taker_id = tt.id
WHERE tt.email = 'tank_howard@hotmail.com'
ORDER BY ts.score DESC;
```

### 3. 查詢受測者的向度分數與排名

```sql
SELECT
    dd.name_zh AS 向度名稱,
    ds.score AS 分數,
    dd.description AS 說明,
    RANK() OVER (PARTITION BY ds.assessment_record_id ORDER BY ds.score DESC) AS 排名
FROM dimension_scores ds
JOIN dimension_definitions dd ON ds.dimension_id = dd.id
JOIN assessment_records ar ON ds.assessment_record_id = ar.id
JOIN test_takers tt ON ar.test_taker_id = tt.id
WHERE tt.email = 'tank_howard@hotmail.com'
ORDER BY ds.score DESC;
```

### 4. 查詢優勢向度的標籤

```sql
SELECT
    dd.name_zh AS 向度名稱,
    GROUP_CONCAT(tg.name_zh, ', ') AS 標籤列表
FROM dimension_tags dt
JOIN dimension_definitions dd ON dt.dimension_id = dd.id
JOIN tag_definitions tg ON dt.tag_id = tg.id
JOIN assessment_records ar ON dt.assessment_record_id = ar.id
JOIN test_takers tt ON ar.test_taker_id = tt.id
WHERE tt.email = 'tank_howard@hotmail.com'
  AND tg.tag_type = 'strength'
GROUP BY dd.name_zh;
```

### 5. 查詢針對特定向度的面試問題

```sql
SELECT
    dd.name_zh AS 向度名稱,
    iq.question_text AS 面試問題,
    iq.question_type AS 問題類型
FROM interview_questions iq
JOIN dimension_definitions dd ON iq.dimension_id = dd.id
WHERE dd.code = 'integrity_trustworthiness'
ORDER BY iq.display_order;
```

### 6. 查詢綜合分析結果

```sql
SELECT
    tt.name AS 受測者姓名,
    sd.name_zh AS 優勢向度,
    ca.strength_description AS 優勢描述,
    wd.name_zh AS 劣勢向度,
    ca.weakness_description AS 劣勢描述
FROM comprehensive_analysis ca
JOIN assessment_records ar ON ca.assessment_record_id = ar.id
JOIN test_takers tt ON ar.test_taker_id = tt.id
LEFT JOIN dimension_definitions sd ON ca.strength_dimension_id = sd.id
LEFT JOIN dimension_definitions wd ON ca.weakness_dimension_id = wd.id
WHERE tt.email = 'tank_howard@hotmail.com';
```

---

## 索引建議

為提升查詢效能，建議建立以下索引：

```sql
-- 受測者郵箱索引
CREATE INDEX idx_test_takers_email ON test_takers(email);

-- 評鑑記錄關聯索引
CREATE INDEX idx_assessment_records_test_taker ON assessment_records(test_taker_id);
CREATE INDEX idx_assessment_records_item ON assessment_records(assessment_item_id);
CREATE INDEX idx_assessment_records_status ON assessment_records(status);

-- 特質分數關聯索引
CREATE INDEX idx_trait_scores_record ON trait_scores(assessment_record_id);
CREATE INDEX idx_trait_scores_trait ON trait_scores(trait_id);

-- 向度分數關聯索引
CREATE INDEX idx_dimension_scores_record ON dimension_scores(assessment_record_id);
CREATE INDEX idx_dimension_scores_dimension ON dimension_scores(dimension_id);

-- 標籤關聯索引
CREATE INDEX idx_dimension_tags_record ON dimension_tags(assessment_record_id);
CREATE INDEX idx_dimension_tags_dimension ON dimension_tags(dimension_id);
CREATE INDEX idx_dimension_tags_tag ON dimension_tags(tag_id);

-- 面試問題索引
CREATE INDEX idx_interview_questions_dimension ON interview_questions(dimension_id);
CREATE INDEX idx_interview_questions_type ON interview_questions(question_type);
```

---

## 資料完整性約束

### 業務規則

1. **受測者唯一性**：每個受測者的 email 必須唯一
2. **評鑑狀態管理**：評鑑記錄的狀態包括：pending（待完成）、in_progress（進行中）、completed（已完成）、cancelled（已取消）
3. **分數範圍限制**：所有特質分數和向度分數必須在 0-100 之間
4. **標籤類型限制**：標籤類型只能是 strength（優勢）或 weakness（劣勢）
5. **問題類型限制**：面試問題類型只能是 strength（優勢）或 weakness（劣勢）

### 觸發器建議

```sql
-- 自動更新 updated_at 時間戳
CREATE TRIGGER update_test_takers_timestamp
AFTER UPDATE ON test_takers
BEGIN
    UPDATE test_takers SET updated_at = CURRENT_TIMESTAMP WHERE id = NEW.id;
END;

-- 確保評鑑完成時間晚於邀請時間
CREATE TRIGGER check_assessment_dates
BEFORE INSERT ON assessment_records
BEGIN
    SELECT CASE
        WHEN NEW.completed_at IS NOT NULL
         AND NEW.invited_at IS NOT NULL
         AND NEW.completed_at < NEW.invited_at
        THEN RAISE(ABORT, '完成時間不能早於邀請時間')
    END;
END;
```

---

## 資料遷移與備份建議

### 備份策略

1. **定期備份**：每日自動備份資料庫
2. **增量備份**：每小時進行增量備份
3. **異地備份**：將備份檔案存儲到雲端服務

### 備份腳本範例

```bash
#!/bin/bash
# 資料庫備份腳本

DB_NAME="talent_assessment.db"
BACKUP_DIR="./backups"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="${BACKUP_DIR}/talent_assessment_${DATE}.db"

# 建立備份目錄
mkdir -p ${BACKUP_DIR}

# 執行備份
sqlite3 ${DB_NAME} ".backup ${BACKUP_FILE}"

# 壓縮備份檔案
gzip ${BACKUP_FILE}

echo "備份完成: ${BACKUP_FILE}.gz"

# 刪除 30 天前的備份
find ${BACKUP_DIR} -name "*.gz" -mtime +30 -delete
```

---

## 效能優化建議

### 1. 查詢優化

- 使用適當的索引加速常用查詢
- 避免在大表上使用 SELECT \*
- 使用 EXPLAIN QUERY PLAN 分析查詢效能

### 2. 資料分區

對於大量歷史資料，考慮按年份或季度進行資料分區：

```sql
-- 建立歷史評鑑記錄表
CREATE TABLE assessment_records_2024 AS
SELECT * FROM assessment_records
WHERE strftime('%Y', created_at) = '2024';

-- 從主表刪除已歸檔資料
DELETE FROM assessment_records
WHERE strftime('%Y', created_at) = '2024';
```

### 3. 快取策略

- 快取常用的特質定義和向度定義
- 快取面試問題庫
- 使用 Redis 或 Memcached 進行應用層快取

---

## 安全性考量

### 1. 資料加密

```sql
-- 敏感資料加密（需要使用 SQLCipher 或類似工具）
PRAGMA key = 'your-encryption-key';
```

### 2. 存取控制

- 實施角色基礎存取控制（RBAC）
- 限制直接資料庫存取
- 使用參數化查詢防止 SQL 注入

### 3. 審計日誌

建立審計日誌表記錄重要操作：

```sql
CREATE TABLE audit_logs (
    id TEXT PRIMARY KEY,
    user_id TEXT NOT NULL,
    action TEXT NOT NULL,
    table_name TEXT NOT NULL,
    record_id TEXT,
    old_value TEXT,
    new_value TEXT,
    ip_address TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 附錄：特質與向度對應關係

根據報告內容，以下是特質與向度的推測對應關係：

### 品格誠信素養 (72 分)

- 誠實謙遜 (70)
- 真實性 (66)
- 集體意識 (75)
- 感謝 (91)

### 核心工作動能 (70 分)

- 個人責任感 (86)
- 盡責 (57)
- 工作熱忱 (54)
- 權益公平感 (60)

### 成長創新驅動力 (70 分)

- 個人成長動機 (88)
- 創新力 (59)
- 生活熱情 (63)
- 心理資本 (83)

### 團隊協作與互動能力 (62 分)

- 同理心 (49)
- 集體意識 (75) - 可能同時影響多個向度

---

## 文件版本

- **版本**：1.0
- **建立日期**：2025-10-30
- **最後更新**：2025-10-30
- **作者**：Kiro AI Assistant
- **狀態**：完成

---

## 參考資料

1. 原始報告：綜合人才洞察評鑑特質分析與多向度洞察報告
2. 受測者：Howard (tank_howard@hotmail.com)
3. 測驗項目：綜合人才洞察評鑑 (Comprehensive Insight Assessment)
4. 評鑑時間：2025 年 09 月 02 日 - 2025 年 09 月 03 日
