# 語音處理系統 - 總覽

**系統版本**: 1.0  
**文檔日期**: 2025-11-21  
**系統狀態**: ✅ 運行中

---

## 📋 系統概述

語音處理系統是 AI 客服平台的核心技術模組，整合了語音克隆、語音分析、語音合成、語音互動等多項先進技術，為平台提供完整的語音處理能力。

### 核心特色

- 🎤 **語音克隆**: GPT-SoVITS 高品質語音克隆
- 📊 **語音分析**: 雙引擎情緒識別（基礎/進階）
- 🔊 **語音合成**: 多語言 TTS 支援
- 💬 **語音互動**: 即時語音識別與 AI 對話
- 💝 **語音關懷**: 智能化定期關懷服務

---

## 🏗️ 系統架構

### 整體架構圖

```
語音處理系統
│
├── 語音克隆模組
│   ├── 語音樣本處理
│   ├── 模型訓練
│   └── 語音生成
│
├── 語音分析模組
│   ├── 基礎情緒識別（librosa）
│   ├── 進階情緒識別（Wav2Vec2）
│   └── 批次分析
│
├── 語音合成模組
│   ├── GPT-SoVITS TTS
│   ├── F5-TTS
│   └── Qwen TTS
│
├── 語音互動模組
│   ├── 即時語音識別（Qwen ASR）
│   ├── AI 對話（DeepSeek）
│   └── 流式語音合成
│
└── 語音關懷模組
    ├── 智能排程
    ├── 訊息生成
    └── 雙語語音合成
```

### 技術棧

| 層級     | 技術                         |
| -------- | ---------------------------- |
| 語音識別 | Qwen ASR, Whisper, FunASR    |
| 語音合成 | GPT-SoVITS, Qwen TTS, F5-TTS |
| 情緒識別 | librosa, Wav2Vec2            |
| AI 對話  | DeepSeek LLM                 |
| 後端框架 | Flask                        |
| 資料庫   | SQLite                       |

---

## 📦 模組列表

### 1. 語音克隆模組

**路由**: `/voice_clone/*`  
**服務**: `modules/voice_processing/voice_clone_service.py`  
**技術**: GPT-SoVITS v4

**主要功能**:

- 語音樣本上傳與處理
- 自動降噪與特徵提取
- 語音模型訓練
- 文字轉語音生成
- 語音品質評估

**文檔**: [語音克隆完整說明](./語音克隆完整說明.md)

---

### 2. 語音分析模組（語音測試訓練模組的一部分）

**路由**: `/api/emotion/*`  
**服務**: `services/emotion_recognition.py`, `services/emotion_recognition_advanced.py`  
**技術**: librosa, Wav2Vec2

**主要功能**:

- 基礎情緒識別（快速）
- 進階情緒識別（高精度）
- 批次情緒分析
- 即時上傳分析
- 模型管理

**文檔**: [語音測試訓練模組完整說明](../語音測試訓練模組_完整說明.md)

---

### 3. 語音合成模組（語音測試訓練模組的一部分）

**路由**: `/simple_tts/*`  
**服務**: `services/gpt_sovits_service.py`  
**技術**: GPT-SoVITS v4

**主要功能**:

- 文字轉語音
- 參考音頻選擇
- 語速控制
- 音色克隆

**文檔**: [語音測試訓練模組完整說明](../語音測試訓練模組_完整說明.md)

---

### 4. 語音互動模組

**路由**: `/voice_interaction_realtime/*`  
**服務**: `services/realtime_interaction_service.py`  
**技術**: Qwen ASR, DeepSeek LLM, Qwen TTS

**主要功能**:

- 即時語音識別
- 智能對話回應
- 流式語音合成
- 雙語支援（國語/閩南語）
- 多輪對話管理

**文檔**: [語音互動文檔](../語音互動/)

---

### 5. 語音關懷模組

**路由**: `/api/voice-care/*`  
**服務**: `modules/voice_processing/voice_care_service.py`  
**技術**: DeepSeek LLM, Qwen TTS

**主要功能**:

- 智能排程管理
- AI 訊息生成
- 雙語語音合成
- 天氣資訊整合
- 關懷效果追蹤

**文檔**: [智慧語音關懷系統完整說明](../智慧語音關懷系統_完整說明.md)

---

## 🔄 模組關係

### 依賴關係

```
語音克隆 ──┐
           ├──> GPT-SoVITS 服務
語音合成 ──┘

語音分析 ──> librosa / Wav2Vec2

語音互動 ──┬──> Qwen ASR
           ├──> DeepSeek LLM
           └──> Qwen TTS

語音關懷 ──┬──> DeepSeek LLM
           ├──> Qwen TTS
           └──> 天氣服務
```

### 數據流

```
用戶輸入（音頻/文字）
    ↓
語音識別（如需要）
    ↓
AI 處理（分析/對話/生成）
    ↓
語音合成（如需要）
    ↓
輸出（音頻/文字/分析結果）
```

---

## 📊 性能指標

### 整體性能

| 模組             | 平均處理時間 | 準確度/品質 | 並發能力 |
| ---------------- | ------------ | ----------- | -------- |
| 語音克隆         | 5-10 秒      | 高          | 3-5      |
| 語音分析（基礎） | < 1 秒       | 72%         | 10+      |
| 語音分析（進階） | 2-5 秒       | 87%         | 5+       |
| 語音合成         | 3-8 秒       | 高          | 3-5      |
| 語音互動         | 2-4 秒       | 高          | 5-10     |
| 語音關懷         | 8-10 秒      | 高          | 5+       |

---

## 🚀 快速開始

### 啟動服務

```bash
# 使用啟動腳本
bStart.bat

# 或手動啟動
python app.py
```

### 訪問入口

**Portal 入口**:

```
http://localhost:5000/portal
```

**直接訪問**:

- 語音克隆: `http://localhost:5000/voice_clone/demo`
- 語音分析: 通過 API 調用
- 語音合成: `http://localhost:5000/simple_tts/demo`
- 語音互動: `http://localhost:5000/voice_interaction_realtime/`
- 語音關懷: `http://localhost:5000/api/voice-care/schedules-page`

---

## 📚 文檔索引

### 模組文檔

1. [語音克隆完整說明](./語音克隆完整說明.md)
2. [語音測試訓練模組完整說明](../語音測試訓練模組_完整說明.md)
3. [智慧語音關懷系統完整說明](../智慧語音關懷系統_完整說明.md)
4. [語音互動文檔](../語音互動/)

### 技術文檔

1. [GPT-SoVITS 整合指南](../technical/voice/gpt_sovits.md)
2. [Qwen TTS 使用指南](../technical/voice/qwen_tts.md)
3. [情緒識別技術文檔](../technical/voice/emotion_recognition.md)

### API 文檔

1. [語音克隆 API](./API文檔.md#語音克隆)
2. [語音分析 API](./API文檔.md#語音分析)
3. [語音合成 API](./API文檔.md#語音合成)
4. [語音互動 API](./API文檔.md#語音互動)
5. [語音關懷 API](./API文檔.md#語音關懷)

---

## 🔧 配置說明

### 環境變數

```bash
# GPT-SoVITS 服務
GPT_SOVITS_URL=http://localhost:9880

# Qwen 服務
DASHSCOPE_API_KEY=your_dashscope_key

# DeepSeek 服務
DEEPSEEK_API_KEY=your_deepseek_key

# 音頻存儲路徑
AUDIO_UPLOAD_DIR=./audio_uploads
MOCKVOICE_DIR=./mockvoice
OUTPUT_DIR=./genvoice
```

### 服務端口

| 服務         | 端口 | 說明         |
| ------------ | ---- | ------------ |
| Flask 主應用 | 5000 | 主服務       |
| GPT-SoVITS   | 9880 | 語音克隆服務 |

---

## 🐛 故障排除

### 常見問題

#### 問題 1：語音服務無法啟動

**症狀**: API 調用失敗  
**解決**:

1. 檢查 GPT-SoVITS 服務是否運行
2. 確認環境變數設置正確
3. 查看日誌文件

#### 問題 2：語音品質不佳

**症狀**: 生成的語音不自然  
**解決**:

1. 檢查參考音頻品質
2. 調整語速參數
3. 使用更長的參考音頻

#### 問題 3：處理速度慢

**症狀**: 響應時間過長  
**解決**:

1. 檢查系統資源使用
2. 考慮使用基礎版本（如情緒識別）
3. 優化並發設置

---

## 📈 未來規劃

### 短期目標（1-3 個月）

- [ ] 添加更多語言支援
- [ ] 優化處理速度
- [ ] 改善語音品質
- [ ] 添加更多情緒類型

### 中期目標（3-6 個月）

- [ ] 實現即時語音轉換
- [ ] 添加語音美化功能
- [ ] 支援更多音色
- [ ] 優化模型大小

### 長期目標（6-12 個月）

- [ ] 本地化部署方案
- [ ] 移動端支援
- [ ] 多人對話支援
- [ ] 實時語音翻譯

---

## 📞 技術支援

**開發團隊**: AI 開發團隊  
**維護負責人**: 系統優化小組  
**問題回報**: 專案 Issue 系統

---

## 📝 版本歷史

| 版本 | 日期       | 說明                 |
| ---- | ---------- | -------------------- |
| 1.0  | 2025-11-21 | 初始文檔化，系統總覽 |

---

**最後更新**: 2025-11-21  
**文檔狀態**: ✅ 已完成  
**系統狀態**: ✅ 生產環境運行中
