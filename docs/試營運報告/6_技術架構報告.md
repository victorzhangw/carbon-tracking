# 6. 技術架構與系統穩定性

## 6.1 系統架構說明

### 整體架構圖

```
┌─────────────────────────────────────────────────┐
│              使用者介面層                          │
├─────────────┬─────────────┬─────────────────────┤
│  Web 介面   │  Android APP │   管理後台           │
└─────────────┴─────────────┴─────────────────────┘
                      ↓
┌─────────────────────────────────────────────────┐
│              應用服務層                            │
├─────────────┬─────────────┬─────────────────────┤
│ 碳排放追蹤  │  AI關懷系統  │   語音處理服務       │
└─────────────┴─────────────┴─────────────────────┘
                      ↓
┌─────────────────────────────────────────────────┐
│              核心服務層                            │
├─────────────┬─────────────┬─────────────────────┤
│  Qwen TTS   │  DeepSeek AI │  雙引擎ASR          │
└─────────────┴─────────────┴─────────────────────┘
                      ↓
┌─────────────────────────────────────────────────┐
│              資料存儲層                            │
├─────────────┬─────────────┬─────────────────────┤
│  SQLite DB  │  檔案儲存    │   快取系統           │
└─────────────┴─────────────┴─────────────────────┘
```

### 技術堆疊

**後端框架**:

- Python 3.x
- Flask Web Framework
- SQLite Database

**AI/ML 服務**:

- Qwen TTS (語音合成)
- DeepSeek AI (對話生成)
- Whisper ASR (語音辨識)
- FunASR (台語辨識)

**前端技術**:

- HTML5 / CSS3 / JavaScript
- Bootstrap 5
- Chart.js (圖表)
- PWA (漸進式網頁應用)

**行動應用**:

- Android (Kotlin)
- WebView 整合

## 6.2 技術選型理由

### Flask 框架

- ✅ **輕量快速**: 適合中小型專案
- ✅ **易於開發**: Python 生態系完整
- ✅ **彈性高**: 可自由組合元件

### SQLite 資料庫

- ✅ **零配置**: 無需額外安裝
- ✅ **輕量級**: 適合單機部署
- ✅ **可靠性**: 資料完整性保證

### Qwen TTS

- ✅ **高品質**: 語音自然流暢
- ✅ **多語言**: 支援國語、台語
- ✅ **多角色**: 適合廣播劇製作

### 雙引擎 ASR

- ✅ **準確度高**: Whisper + FunASR 互補
- ✅ **台語支援**: FunASR 專精閩南語
- ✅ **長者友善**: 針對長者語音優化

## 6.3 系統穩定性數據

### 運行時間統計

| 指標                  | 數值     |
| --------------------- | -------- |
| 總運行天數            | [X] 天   |
| 系統正常運行時間      | [X] 小時 |
| 系統可用率            | [X]%     |
| 平均無故障時間 (MTBF) | [X] 小時 |
| 平均修復時間 (MTTR)   | [X] 分鐘 |

### 故障記錄

| 日期   | 故障類型 | 影響範圍 | 修復時間 | 原因   |
| ------ | -------- | -------- | -------- | ------ |
| [日期] | [類型]   | [範圍]   | [時間]   | [原因] |

### 系統異常分析

```
異常類型分布:
- API 逾時: [X] 次 ([X]%)
- 資料庫錯誤: [X] 次 ([X]%)
- 網路問題: [X] 次 ([X]%)
- 其他: [X] 次 ([X]%)
```

## 6.4 效能監控結果

### API 回應時間

| API 端點         | 平均回應時間 | 最大回應時間 | 成功率 |
| ---------------- | ------------ | ------------ | ------ |
| /carbon_tracking | [X] ms       | [X] ms       | [X]%   |
| /voice_care      | [X] ms       | [X] ms       | [X]%   |
| /audiobook       | [X] ms       | [X] ms       | [X]%   |
| /asr             | [X] ms       | [X] ms       | [X]%   |

### 資源使用率

```
伺服器資源:
- CPU 平均使用率: [X]%
- 記憶體平均使用率: [X]%
- 磁碟使用率: [X]%
- 網路頻寬: [X] Mbps
```

### 資料庫效能

```
- 平均查詢時間: [X] ms
- 最慢查詢: [X] ms
- 資料庫大小: [X] MB
- 記錄總數: [X] 筆
```

## 6.5 安全性評估

### 資料安全

- ✅ **資料加密**: 敏感資料加密儲存
- ✅ **存取控制**: 身份驗證與授權機制
- ✅ **備份機制**: 每日自動備份
- ✅ **隱私保護**: 符合個資法規範

### 網路安全

- ✅ **HTTPS**: 傳輸加密
- ✅ **防火牆**: 限制存取來源
- ✅ **日誌記錄**: 完整操作記錄
- ✅ **異常偵測**: 自動告警機制

### 安全測試結果

| 測試項目     | 結果    | 備註           |
| ------------ | ------- | -------------- |
| SQL 注入測試 | ✅ 通過 | 使用參數化查詢 |
| XSS 攻擊測試 | ✅ 通過 | 輸入驗證與過濾 |
| CSRF 防護    | ✅ 通過 | Token 驗證     |
| 權限控制     | ✅ 通過 | 角色權限管理   |

## 6.6 擴展性評估

### 水平擴展能力

```
目前配置:
- 單一伺服器部署
- 支援 [X] 個並發用戶

擴展方案:
- 可增加伺服器節點
- 負載平衡機制
- 預估可支援 [X] 個並發用戶
```

### 垂直擴展能力

```
硬體升級方案:
- CPU: 可升級至 [X] 核心
- RAM: 可擴充至 [X] GB
- 儲存: 可擴充至 [X] TB
```

### 功能擴展性

- ✅ **模組化設計**: 易於新增功能
- ✅ **API 介面**: 支援第三方整合
- ✅ **插件機制**: 可擴充語音引擎

## 6.7 維護與監控

### 監控機制

- 📊 **系統監控**: CPU、記憶體、磁碟
- 📊 **應用監控**: API 回應時間、錯誤率
- 📊 **業務監控**: 服務量、使用率

### 告警機制

```
告警規則:
- CPU 使用率 > 80%
- 記憶體使用率 > 85%
- API 錯誤率 > 5%
- 系統無回應 > 5 分鐘
```

### 維護計畫

- 🔧 **每日**: 自動備份、日誌檢查
- 🔧 **每週**: 效能分析、安全掃描
- 🔧 **每月**: 系統更新、容量規劃

## 6.8 技術債務與改善計畫

### 已知技術債務

1. [描述技術債務 1]
2. [描述技術債務 2]

### 改善計畫

- [ ] [改善項目 1] - 預計 [時間]
- [ ] [改善項目 2] - 預計 [時間]

---

**參考資料**:

- [附件 1: 系統架構圖](./佐證資料/系統架構圖.pdf)
- [附件 2: API 文件](./佐證資料/API文件.pdf)
- [附件 3: 效能測試報告](./佐證資料/效能測試報告.pdf)

**下一章節**: [7. 問題挑戰與未來展望](./7_問題挑戰與未來展望.md)
