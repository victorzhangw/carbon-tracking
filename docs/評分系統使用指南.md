# 📊 評分系統使用指南

## ✅ 系統狀態

**所有功能已完整實施並測試通過！**

- ✅ 後端服務（資料庫 + 評分計算）
- ✅ 前端整合（情緒分析頁面）
- ✅ 評分分析子模組
- ✅ API 端點
- ✅ 路由配置

## 🚀 快速開始

### 1. 啟動應用

```bash
# 方式 1: 使用批次檔
bStart.bat

# 方式 2: 直接啟動
python app.py
```

### 2. 訪問系統

打開瀏覽器訪問以下地址：

- **情緒分析系統**: http://localhost:5000/emotion-analysis
- **評分分析頁面**: http://localhost:5000/score-analysis
- **語音測試入口**: http://localhost:5000/voice-testing

## 📖 使用流程

### 情緒分析 + 評分系統

1. **進入情緒分析頁面**

   - 訪問 http://localhost:5000/emotion-analysis

2. **開始對話**

   - 點擊「🎤 開始錄音」按鈕
   - 說出你想說的話
   - 點擊「⏹️ 停止錄音」
   - 等待 AI 回應

3. **進行多輪對話**

   - 重複步驟 2，進行多輪對話
   - 建議至少進行 3-5 輪對話以獲得更準確的評分

4. **結束對話並查看評分**

   - 點擊「🏁 結束對話」按鈕
   - 確認結束對話
   - 查看評分報告彈窗

5. **評分報告內容**
   - 📊 雷達圖：視覺化展示三維度評分
   - 🎯 情緒表達評分（35%）
   - 🎤 語音品質評分（35%）
   - 📝 文字內容評分（30%）
   - ⭐ 綜合評分和等級（S/A/B/C/D）
   - 💡 個性化改進建議
   - 📈 統計資訊（對話輪數、總字數、持續時間）

### 評分分析頁面

1. **進入評分分析頁面**

   - 訪問 http://localhost:5000/score-analysis
   - 或從語音測試入口進入

2. **查看統計資訊**

   - 總會話數
   - 平均評分
   - 最佳評分
   - 最差評分

3. **查看歷史記錄**

   - 所有會話的評分記錄
   - 每次會話的詳細評分
   - 時間趨勢分析

4. **查看趨勢圖表**
   - 評分變化趨勢
   - 各維度表現對比

## 🎯 評分維度說明

### 情緒表達 (35%)

評估對話中的情緒表現，包括：

- **多樣性 (30%)**: 情緒種類的豐富程度
- **恰當性 (40%)**: 情緒表達是否符合情境
- **強度 (20%)**: 情緒表達的強烈程度
- **一致性 (10%)**: 情緒表達的連貫性

### 語音品質 (35%)

評估語音的技術品質，包括：

- **清晰度 (40%)**: 發音清晰程度
- **音量 (20%)**: 音量適中程度
- **語速 (20%)**: 語速適當程度
- **流暢度 (20%)**: 語言流暢程度

### 文字內容 (30%)

評估對話的文字內容品質，包括：

- **長度 (20%)**: 回應長度適當性
- **豐富度 (30%)**: 詞彙和內容豐富程度
- **連貫性 (30%)**: 對話邏輯連貫性
- **參與度 (20%)**: 對話參與積極性

## 📊 評分等級

| 等級 | 分數範圍 | 星級       | 稱號   | 說明         |
| ---- | -------- | ---------- | ------ | ------------ |
| S    | 95-100   | ⭐⭐⭐⭐⭐ | 大師級 | 表現卓越     |
| A    | 85-94    | ⭐⭐⭐⭐   | 優秀   | 表現優異     |
| B    | 75-84    | ⭐⭐⭐     | 良好   | 表現良好     |
| C    | 60-74    | ⭐⭐       | 及格   | 達到基本要求 |
| D    | 0-59     | ⭐         | 待改進 | 需要加強練習 |

## 💡 改進建議系統

系統會根據你的評分自動生成個性化建議：

### 情緒表達建議

- 情緒多樣性不足 → 建議嘗試表達更多不同的情緒
- 情緒恰當性較低 → 建議注意情境，表達合適的情緒
- 情緒強度不足 → 建議更明確地表達感受

### 語音品質建議

- 清晰度不足 → 建議放慢語速，咬字清晰
- 音量問題 → 建議調整麥克風距離或音量
- 語速問題 → 建議保持適中的語速
- 流暢度不足 → 建議減少停頓，保持流暢

### 文字內容建議

- 回應過短 → 建議說得更詳細一些
- 詞彙單一 → 建議使用更豐富的詞彙
- 邏輯不連貫 → 建議注意對話的邏輯性
- 參與度低 → 建議更積極地參與對話

## 🔧 技術架構

### 後端服務

```
services/
├── score_database.py      # 資料庫服務
│   ├── 6 張資料表
│   ├── CRUD 操作
│   └── 統計查詢
│
└── score_calculator.py    # 評分計算服務
    ├── 情緒評分算法
    ├── 語音評分算法
    ├── 文字評分算法
    └── 建議生成邏輯
```

### 前端組件

```
templates/
├── emotion_analysis.html       # 情緒分析主頁面（已整合評分系統）
├── score_analysis.html         # 評分分析頁面
└── score_report_modal.html     # 評分報告彈窗

static/
├── css/
│   └── score_report.css        # 評分報告樣式
└── js/
    └── score_manager.js        # 評分管理器
```

### API 端點

```
POST /api/end-session
- 結束對話並生成評分報告
- 參數: session_id, user_id, conversation_history, duration
- 返回: scores, grade, stars, suggestions, statistics

GET /api/score-history?user_id=xxx&limit=10
- 獲取用戶的歷史評分記錄
- 參數: user_id (可選), limit (可選)
- 返回: records, statistics
```

## 📁 資料庫結構

```sql
-- 用戶表
users (id, user_id, username, email, created_at)

-- 會話表
sessions (id, session_id, user_id, start_time, end_time, duration, device_type, browser, ip_address)

-- 對話記錄表
conversations (id, session_id, speaker, text, sentiment, audio_quality, word_count, timestamp)

-- 評分記錄表
score_records (id, session_id, user_id, overall_score, emotion_score, voice_score, content_score, grade, stars, title, conversation_count, total_words, duration, created_at)

-- 評分詳情表
score_details (id, record_id, category, subcategory, score, weight, description)

-- 改進建議表
suggestions (id, record_id, category, icon, text, priority)
```

## 🧪 測試

### 運行測試腳本

```bash
# 測試資料庫功能
python test_score_db.py

# 測試完整系統
python test_complete_system.py

# 測試 Flask 啟動
python test_flask_startup.py
```

### 測試結果

所有測試均已通過：

- ✅ 資料庫初始化
- ✅ 用戶和會話管理
- ✅ 對話記錄
- ✅ 評分計算
- ✅ 評分記錄保存
- ✅ 歷史記錄查詢
- ✅ 統計資訊查詢
- ✅ 路由配置
- ✅ 模板文件
- ✅ 靜態文件

## 🎊 功能特色

1. **多維度評分**: 從情緒、語音、文字三個維度全面評估對話品質
2. **智能建議**: 根據評分自動生成個性化改進建議
3. **視覺化展示**: 雷達圖直觀展示各維度表現
4. **歷史追蹤**: 完整記錄所有會話的評分歷史
5. **趨勢分析**: 查看評分變化趨勢，追蹤進步
6. **等級系統**: S/A/B/C/D 五級評分，激勵持續改進
7. **統計分析**: 提供總會話數、平均分、最佳分等統計資訊

## 📝 使用建議

1. **定期練習**: 建議每天進行 2-3 次對話練習
2. **多樣化對話**: 嘗試不同主題和情境的對話
3. **關注建議**: 認真閱讀系統給出的改進建議
4. **追蹤進步**: 定期查看評分分析頁面，了解自己的進步
5. **設定目標**: 為自己設定評分目標，逐步提升

## 🔍 常見問題

### Q1: 為什麼我的評分很低？

A: 評分低可能是因為：

- 對話輪數太少（建議至少 3-5 輪）
- 回應過於簡短
- 情緒表達不夠豐富
- 語音品質問題

建議查看系統給出的改進建議，針對性地改進。

### Q2: 如何提高評分？

A: 提高評分的方法：

- 增加對話輪數
- 豐富情緒表達
- 說得更詳細一些
- 注意語音清晰度
- 保持對話連貫性

### Q3: 評分報告在哪裡查看？

A: 有兩種方式：

1. 在情緒分析頁面點擊「結束對話」後立即查看
2. 訪問評分分析頁面查看歷史記錄

### Q4: 可以刪除歷史記錄嗎？

A: 目前系統會保留所有歷史記錄用於趨勢分析。如需刪除，可以直接刪除 `carbon_tracking.db` 資料庫文件（會清空所有數據）。

### Q5: 評分算法是如何計算的？

A: 評分算法基於多個因素：

- 情緒多樣性、恰當性、強度、一致性
- 語音清晰度、音量、語速、流暢度
- 文字長度、豐富度、連貫性、參與度

每個因素都有不同的權重，最終計算出綜合評分。

## 📞 技術支援

如遇到問題，請檢查：

1. Flask 服務器是否正常運行
2. 瀏覽器控制台是否有錯誤訊息
3. 資料庫文件 `carbon_tracking.db` 是否存在
4. 所有必要的文件是否完整

## 🎉 總結

評分系統已經完整實施並測試通過，所有功能都可以正常使用。現在你可以：

1. 啟動應用
2. 進行對話練習
3. 查看評分報告
4. 追蹤進步趨勢
5. 根據建議改進

祝你使用愉快，不斷進步！🚀

---

**文檔版本**: 1.0  
**最後更新**: 2025-11-22  
**狀態**: ✅ 完整實施並測試通過
