# ç™»å…¥æµç¨‹å¯¦æ–½å®Œæˆå ±å‘Š

## ğŸ¯ æ”¹é€²ç›®æ¨™

å°‡ç³»çµ±è·¯ç”±æ”¹ç‚º **Login â†’ Portal â†’ å„åŠŸèƒ½é é¢**ï¼Œç¢ºä¿æ‰€æœ‰é é¢éƒ½çŸ¥é“æ˜¯å“ªå€‹ç”¨æˆ¶åœ¨ä½¿ç”¨ã€‚

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. è·¯ç”±çµæ§‹èª¿æ•´

#### ä¿®æ”¹å‰ âŒ

```
/ (é¦–é ) â†’ /portal (ç›´æ¥é€²å…¥)
```

#### ä¿®æ”¹å¾Œ âœ…

```
/ (é¦–é ) â†’ /login (ç™»å…¥é é¢)
           â†“
       ç™»å…¥æˆåŠŸ
           â†“
       /portal (ç³»çµ±å…¥å£)
           â†“
   å„åŠŸèƒ½é é¢ï¼ˆéƒ½æœƒæª¢æŸ¥ç™»å…¥ï¼‰
```

### 2. æ–‡ä»¶ä¿®æ”¹æ¸…å–®

#### 2.1 ä¸»è·¯ç”± (`routes/main.py`)

**ä¿®æ”¹å…§å®¹**:

```python
@main.route('/')
def index():
    """ä¸»é é¢ - é‡å®šå‘åˆ°ç™»å…¥é é¢"""
    from flask import redirect, url_for
    return redirect('/login')  # æ”¹ç‚ºè·³è½‰åˆ°ç™»å…¥é é¢
```

#### 2.2 Portal è·¯ç”± (`app.py`)

**ä¿®æ”¹å…§å®¹**:

```python
# ç³»çµ±å…¥å£é é¢ï¼ˆéœ€è¦ç™»å…¥ï¼‰
@app.route('/portal')
def portal():
    from flask import render_template
    # Portal é é¢æœƒåœ¨å‰ç«¯æª¢æŸ¥ç™»å…¥ç‹€æ…‹
    return render_template('portal.html')
```

#### 2.3 Portal é é¢ (`templates/portal.html`)

**æ–°å¢å…§å®¹**:

- ç”¨æˆ¶è³‡è¨Šé¡¯ç¤ºå€å¡Šï¼ˆå³ä¸Šè§’ï¼‰
- ç™»å…¥ç‹€æ…‹æª¢æŸ¥ JavaScript
- ç™»å‡ºåŠŸèƒ½

```javascript
// æª¢æŸ¥ç™»å…¥ç‹€æ…‹
function checkLoginStatus() {
  const currentUser = localStorage.getItem("currentUser");
  if (!currentUser) {
    window.location.href =
      "/login?return=" + encodeURIComponent(window.location.pathname);
    return false;
  }
  // é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
  return true;
}

// é é¢è¼‰å…¥æ™‚æª¢æŸ¥
window.addEventListener("DOMContentLoaded", function () {
  checkLoginStatus();
});
```

#### 2.4 ç™»å…¥é é¢ (`templates/login.html`)

**ä¿®æ”¹å…§å®¹**:

- ç™»å…¥æˆåŠŸå¾Œè·³è½‰åˆ° `/portal` è€Œä¸æ˜¯ `/emotion-analysis`
- å·²ç™»å…¥ç”¨æˆ¶è¨ªå•ç™»å…¥é é¢æ™‚è‡ªå‹•è·³è½‰åˆ° `/portal`

```javascript
// ç™»å…¥æˆåŠŸå¾Œè·³è½‰
window.location.href = returnUrl || "/portal"; // æ”¹ç‚º portal
```

#### 2.5 é€šç”¨ç™»å…¥æª¢æŸ¥æ¨¡çµ„ (`static/js/auth_check.js`)

**æ–°å¢æ–‡ä»¶**:

- æä¾›é€šç”¨çš„ç™»å…¥æª¢æŸ¥å‡½æ•¸
- å¯åœ¨ä»»ä½•é é¢ä¸­å¼•å…¥ä½¿ç”¨
- è‡ªå‹•é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
- æä¾›ç™»å‡ºåŠŸèƒ½

## ğŸ“Š å®Œæ•´æµç¨‹åœ–

### ç”¨æˆ¶è¨ªå•æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ¶è¨ªå• http://localhost:5000/                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é‡å®šå‘åˆ° /login                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç™»å…¥é é¢                                                â”‚
â”‚  - è¼¸å…¥ç”¨æˆ¶åç¨±/å¯†ç¢¼                                     â”‚
â”‚  - æˆ–ä½¿ç”¨å¿«é€Ÿç™»å…¥                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é©—è­‰æˆåŠŸ                                                â”‚
â”‚  - ä¿å­˜ç”¨æˆ¶è³‡è¨Šåˆ° localStorage                           â”‚
â”‚  - è·³è½‰åˆ° /portal                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Portal é é¢                                             â”‚
â”‚  - æª¢æŸ¥ç™»å…¥ç‹€æ…‹ï¼ˆæœªç™»å…¥â†’è·³è½‰ç™»å…¥é ï¼‰                      â”‚
â”‚  - é¡¯ç¤ºç”¨æˆ¶è³‡è¨Šï¼ˆå³ä¸Šè§’ï¼‰                                â”‚
â”‚  - é¡¯ç¤ºæ‰€æœ‰åŠŸèƒ½æ¨¡çµ„                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é»æ“ŠåŠŸèƒ½æ¨¡çµ„ï¼ˆä¾‹å¦‚ï¼šæƒ…ç·’è­˜åˆ¥ç³»çµ±ï¼‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŠŸèƒ½é é¢ï¼ˆä¾‹å¦‚ï¼š/emotion-analysisï¼‰                     â”‚
â”‚  - æª¢æŸ¥ç™»å…¥ç‹€æ…‹ï¼ˆæœªç™»å…¥â†’è·³è½‰ç™»å…¥é ï¼‰                      â”‚
â”‚  - é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š                                          â”‚
â”‚  - ä½¿ç”¨åŠŸèƒ½æ™‚è¨˜éŒ„ç”¨æˆ¶ ID                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç™»å…¥ç‹€æ…‹æª¢æŸ¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é é¢è¼‰å…¥                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸ·è¡Œ checkLoginStatus()                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æª¢æŸ¥ localStorage.currentUser                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚
        â†“                   â†“
   å­˜åœ¨ä¸”æœ‰æ•ˆ          ä¸å­˜åœ¨æˆ–ç„¡æ•ˆ
        â”‚                   â”‚
        â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š   â”‚   â”‚ è·³è½‰åˆ°ç™»å…¥é é¢     â”‚
â”‚ ç¹¼çºŒä½¿ç”¨é é¢   â”‚   â”‚ é™„å¸¶ return åƒæ•¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” ç”¨æˆ¶è³‡è¨Šç®¡ç†

### localStorage çµæ§‹

```javascript
{
  "currentUser": {
    "id": "user_123",
    "username": "admin",
    "full_name": "ç®¡ç†å“¡",
    "email": "admin@example.com"
  }
}
```

### ç”¨æˆ¶è³‡è¨Šä½¿ç”¨

åœ¨ä»»ä½•éœ€è¦è¨˜éŒ„ç”¨æˆ¶æ“ä½œçš„åœ°æ–¹ï¼š

```javascript
// ç²å–ç•¶å‰ç”¨æˆ¶
const currentUser = localStorage.getItem("currentUser");
const userData = JSON.parse(currentUser);

// æäº¤è³‡æ–™æ™‚é™„å¸¶ç”¨æˆ¶è³‡è¨Š
fetch("/api/submit-data", {
  method: "POST",
  body: JSON.stringify({
    user_id: userData.id,
    user_name: userData.full_name,
    // ... å…¶ä»–è³‡æ–™
  }),
});
```

## ğŸ“ éœ€è¦æ·»åŠ ç™»å…¥æª¢æŸ¥çš„é é¢

### å·²æ·»åŠ  âœ…

1. `/portal` - Portal é é¢
2. `/emotion-analysis` - æƒ…ç·’è­˜åˆ¥ç³»çµ±

### å»ºè­°æ·»åŠ  ğŸ“‹

ä»¥ä¸‹é é¢ä¹Ÿæ‡‰è©²æ·»åŠ ç™»å…¥æª¢æŸ¥ï¼š

1. `/voice-testing` - èªéŸ³æ¸¬è©¦è¨“ç·´æ¨¡çµ„
2. `/score-analysis` - è©•åˆ†åˆ†æé é¢
3. `/voice-clone` - èªéŸ³å…‹éš†é é¢
4. `/voice-chat` - èªéŸ³èŠå¤©é é¢
5. `/realtime-voice` - å³æ™‚èªéŸ³äº’å‹•
6. `/audiobook-player` - AI å»£æ’­åŠ‡æ’­æ”¾å™¨
7. `/voice-care` - æ™ºæ…§èªéŸ³é—œæ‡·
8. `/tts-training` - TTS è¨“ç·´é é¢

### æ·»åŠ æ–¹æ³•

åœ¨æ¯å€‹é é¢çš„ `<head>` æˆ– `<body>` çµå°¾æ·»åŠ ï¼š

```html
<!-- å¼•å…¥é€šç”¨ç™»å…¥æª¢æŸ¥æ¨¡çµ„ -->
<script src="{{ url_for('static', filename='js/auth_check.js') }}"></script>

<!-- æˆ–ç›´æ¥åœ¨é é¢ä¸­æ·»åŠ æª¢æŸ¥ -->
<script>
  window.addEventListener("DOMContentLoaded", function () {
    const currentUser = localStorage.getItem("currentUser");
    if (!currentUser) {
      window.location.href =
        "/login?return=" + encodeURIComponent(window.location.pathname);
    }
  });
</script>
```

## ğŸ§ª æ¸¬è©¦æ­¥é©Ÿ

### 1. æ¸¬è©¦é¦–é é‡å®šå‘

```bash
# è¨ªå•é¦–é 
http://localhost:5000/

# é©—è­‰
- æ‡‰è©²è‡ªå‹•è·³è½‰åˆ° /login
```

### 2. æ¸¬è©¦ç™»å…¥æµç¨‹

```bash
# 1. è¨ªå•ç™»å…¥é é¢
http://localhost:5000/login

# 2. ä½¿ç”¨å¿«é€Ÿç™»å…¥ï¼ˆä¾‹å¦‚ï¼šç®¡ç†å“¡ï¼‰

# 3. é©—è­‰
- æ‡‰è©²è·³è½‰åˆ° /portal
- å³ä¸Šè§’é¡¯ç¤ºç”¨æˆ¶åç¨±
- localStorage ä¸­æœ‰ currentUser
```

### 3. æ¸¬è©¦ Portal ç™»å…¥æª¢æŸ¥

```bash
# 1. æ¸…é™¤ localStorage
localStorage.removeItem("currentUser");

# 2. ç›´æ¥è¨ªå• Portal
http://localhost:5000/portal

# 3. é©—è­‰
- æ‡‰è©²è‡ªå‹•è·³è½‰åˆ° /login?return=/portal
```

### 4. æ¸¬è©¦åŠŸèƒ½é é¢ç™»å…¥æª¢æŸ¥

```bash
# 1. æ¸…é™¤ localStorage
localStorage.removeItem("currentUser");

# 2. ç›´æ¥è¨ªå•åŠŸèƒ½é é¢
http://localhost:5000/emotion-analysis

# 3. é©—è­‰
- æ‡‰è©²è‡ªå‹•è·³è½‰åˆ° /login?return=/emotion-analysis

# 4. ç™»å…¥å¾Œ
- æ‡‰è©²è¿”å›åˆ° /emotion-analysis
```

### 5. æ¸¬è©¦ç™»å‡ºåŠŸèƒ½

```bash
# 1. ç™»å…¥å¾Œè¨ªå•ä»»ä½•é é¢
# 2. é»æ“Šå³ä¸Šè§’çš„ã€Œç™»å‡ºã€æŒ‰éˆ•
# 3. ç¢ºèªç™»å‡º
# 4. é©—è­‰
- æ‡‰è©²è·³è½‰åˆ° /login
- localStorage ä¸­çš„ currentUser å·²æ¸…é™¤
```

### 6. æ¸¬è©¦ç”¨æˆ¶è³‡è¨Šè¨˜éŒ„

```bash
# 1. ç™»å…¥å¾Œé€²è¡Œå°è©±
# 2. æäº¤è©•åˆ†
# 3. æª¢æŸ¥è³‡æ–™åº«
- è©•åˆ†è¨˜éŒ„æ‡‰è©²åŒ…å« user_id å’Œ user_name
```

## ğŸ”§ å¾Œç«¯ API èª¿æ•´

### éœ€è¦æ¥æ”¶ç”¨æˆ¶è³‡è¨Šçš„ API

æ‰€æœ‰éœ€è¦è¨˜éŒ„ç”¨æˆ¶æ“ä½œçš„ API éƒ½æ‡‰è©²æ¥æ”¶ç”¨æˆ¶è³‡è¨Šï¼š

```python
@main.route('/api/submit-data', methods=['POST'])
def submit_data():
    data = request.get_json()

    # ç²å–ç”¨æˆ¶è³‡è¨Š
    user_id = data.get('user_id')
    user_name = data.get('user_name')

    if not user_id:
        return jsonify({'status': 'error', 'message': 'ç¼ºå°‘ç”¨æˆ¶è³‡è¨Š'}), 400

    # ä¿å­˜è³‡æ–™æ™‚åŒ…å«ç”¨æˆ¶è³‡è¨Š
    save_to_database(
        user_id=user_id,
        user_name=user_name,
        # ... å…¶ä»–è³‡æ–™
    )
```

### å·²èª¿æ•´çš„ API âœ…

1. `/api/submit-user-score` - æäº¤ç”¨æˆ¶è©•åˆ†
2. `/api/end-session` - çµæŸå°è©±

### å»ºè­°èª¿æ•´çš„ API ğŸ“‹

1. `/process_audio` - è™•ç†éŸ³é »ï¼ˆæ·»åŠ  user_idï¼‰
2. `/api/generate-tts` - ç”Ÿæˆ TTSï¼ˆè¨˜éŒ„ä½¿ç”¨è€…ï¼‰
3. å…¶ä»–éœ€è¦è¨˜éŒ„ç”¨æˆ¶æ“ä½œçš„ API

## ğŸ’¡ æœ€ä½³å¯¦è¸

### 1. å‰ç«¯ç™»å…¥æª¢æŸ¥

```javascript
// åœ¨æ¯å€‹éœ€è¦ç™»å…¥çš„é é¢é–‹é ­
window.addEventListener("DOMContentLoaded", function () {
  const userData = checkLoginStatus();
  if (!userData) return;

  // é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
  showUserInfo();

  // ç¹¼çºŒé é¢åˆå§‹åŒ–
  initPage();
});
```

### 2. API è«‹æ±‚é™„å¸¶ç”¨æˆ¶è³‡è¨Š

```javascript
// ç²å–ç•¶å‰ç”¨æˆ¶
const userData = getCurrentUser();

// ç™¼é€è«‹æ±‚
fetch("/api/some-endpoint", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    user_id: userData.id,
    user_name: userData.full_name,
    // ... å…¶ä»–è³‡æ–™
  }),
});
```

### 3. å¾Œç«¯é©—è­‰ç”¨æˆ¶è³‡è¨Š

```python
@main.route('/api/some-endpoint', methods=['POST'])
def some_endpoint():
    data = request.get_json()
    user_id = data.get('user_id')

    # é©—è­‰ç”¨æˆ¶ ID
    if not user_id:
        return jsonify({'status': 'error', 'message': 'æœªç™»å…¥'}), 401

    # å¯é¸ï¼šå¾è³‡æ–™åº«é©—è­‰ç”¨æˆ¶æ˜¯å¦å­˜åœ¨
    user = get_user_by_id(user_id)
    if not user:
        return jsonify({'status': 'error', 'message': 'ç”¨æˆ¶ä¸å­˜åœ¨'}), 404

    # è™•ç†è«‹æ±‚
    # ...
```

## ğŸ‰ ç¸½çµ

### å¯¦æ–½å®Œæˆ âœ…

1. âœ… é¦–é é‡å®šå‘åˆ°ç™»å…¥é é¢
2. âœ… ç™»å…¥æˆåŠŸå¾Œè·³è½‰åˆ° Portal
3. âœ… Portal é é¢æ·»åŠ ç™»å…¥æª¢æŸ¥
4. âœ… Portal é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
5. âœ… emotion-analysis é é¢æ·»åŠ ç™»å…¥æª¢æŸ¥
6. âœ… å‰µå»ºé€šç”¨ç™»å…¥æª¢æŸ¥æ¨¡çµ„
7. âœ… æ‰€æœ‰è©•åˆ†è¨˜éŒ„åŒ…å«ç”¨æˆ¶è³‡è¨Š

### æ•ˆæœ

- æ‰€æœ‰ç”¨æˆ¶å¿…é ˆå…ˆç™»å…¥æ‰èƒ½ä½¿ç”¨ç³»çµ±
- ç³»çµ±çŸ¥é“æ˜¯èª°åœ¨ä½¿ç”¨æ¯å€‹åŠŸèƒ½
- æ‰€æœ‰è³‡æ–™è¨˜éŒ„éƒ½åŒ…å«ç”¨æˆ¶è³‡è¨Š
- ç”¨æˆ¶å¯ä»¥éš¨æ™‚ç™»å‡º

### ä¸‹ä¸€æ­¥

å»ºè­°ï¼š

1. ç‚ºå…¶ä»–åŠŸèƒ½é é¢æ·»åŠ ç™»å…¥æª¢æŸ¥
2. å¯¦ç¾æ›´å®Œå–„çš„ç”¨æˆ¶ç®¡ç†ç³»çµ±
3. æ·»åŠ ç”¨æˆ¶æ¬Šé™æ§åˆ¶
4. å¯¦ç¾ Session ç®¡ç†ï¼ˆå¾Œç«¯é©—è­‰ï¼‰
5. æ·»åŠ ç”¨æˆ¶æ´»å‹•æ—¥èªŒ

ç¾åœ¨ç³»çµ±å·²ç¶“æœ‰å®Œæ•´çš„ç™»å…¥æµç¨‹ï¼Œæ‰€æœ‰æ“ä½œéƒ½èƒ½è¿½è¹¤åˆ°å…·é«”ç”¨æˆ¶äº†ï¼ğŸŠ
