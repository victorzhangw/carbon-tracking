<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>èªéŸ³å…‹éš†ç³»çµ±æ¼”ç¤º</title>
    <style>
      :root {
        --primary-color: #667eea;
        --primary-dark: #5a6fd8;
        --secondary-color: #764ba2;
        --success-color: #48bb78;
        --warning-color: #ed8936;
        --error-color: #f56565;
        --info-color: #4299e1;
        --text-primary: #2d3748;
        --text-secondary: #718096;
        --bg-primary: #f7fafc;
        --bg-secondary: #edf2f7;
        --border-color: #e2e8f0;
        --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1),
          0 1px 2px 0 rgba(0, 0, 0, 0.06);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Microsoft JhengHei", "Segoe UI", Tahoma, Geneva, Verdana,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: var(--text-primary);
        line-height: 1.6;
        margin: 0;
        padding: 0;
        overflow-x: hidden; /* é˜²æ­¢æ°´å¹³æ»¾å‹• */
      }

      .main-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
        color: white;
      }

      .header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
        max-width: 600px;
        margin: 0 auto;
      }

      .progress-indicator {
        display: flex;
        justify-content: center;
        margin-bottom: 40px;
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: var(--shadow-md);
      }

      .progress-step {
        display: flex;
        align-items: center;
        margin: 0 15px;
        position: relative;
      }

      .progress-step::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 100%;
        width: 30px;
        height: 2px;
        background: var(--border-color);
        transform: translateY(-50%);
      }

      .progress-step:last-child::after {
        display: none;
      }

      .progress-step.completed::after {
        background: var(--success-color);
      }

      .step-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--bg-secondary);
        border: 2px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 10px;
        transition: all 0.3s ease;
      }

      .progress-step.active .step-circle {
        background: var(--primary-color);
        border-color: var(--primary-color);
        color: white;
      }

      .progress-step.completed .step-circle {
        background: var(--success-color);
        border-color: var(--success-color);
        color: white;
      }

      .step-label {
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--text-secondary);
      }

      .progress-step.active .step-label {
        color: var(--primary-color);
        font-weight: 600;
      }

      .progress-step.completed .step-label {
        color: var(--success-color);
        font-weight: 600;
      }

      .container {
        background: white;
        padding: 40px;
        border-radius: 20px;
        box-shadow: var(--shadow-lg);
        margin-bottom: 30px;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .container:hover {
        transform: translateY(-2px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }

      .step {
        opacity: 0.6;
        pointer-events: none;
        transition: all 0.3s ease;
      }

      .step.active {
        opacity: 1;
        pointer-events: auto;
      }

      .step.completed {
        opacity: 0.8;
        pointer-events: auto;
      }

      .step-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
      }

      .step-title::before {
        content: "";
        width: 4px;
        height: 24px;
        background: var(--primary-color);
        margin-right: 12px;
        border-radius: 2px;
      }

      .reading-text {
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        padding: 25px;
        border-radius: 12px;
        border-left: 5px solid var(--info-color);
        line-height: 1.8;
        font-size: 1.1rem;
        margin: 20px 0;
        box-shadow: var(--shadow-sm);
        position: relative;
        overflow: hidden;
      }

      .reading-text::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(
          90deg,
          var(--info-color),
          var(--primary-color)
        );
      }

      .tips-card {
        background: linear-gradient(135deg, #fff5f5 0%, #fed7d7 100%);
        border: 1px solid #feb2b2;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
      }

      .tips-card h4 {
        color: var(--error-color);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
      }

      .tips-card h4::before {
        content: "ğŸ’¡";
        margin-right: 8px;
      }

      .tips-card ul {
        list-style: none;
        padding-left: 0;
      }

      .tips-card li {
        padding: 5px 0;
        position: relative;
        padding-left: 20px;
      }

      .tips-card li::before {
        content: "âœ“";
        position: absolute;
        left: 0;
        color: var(--success-color);
        font-weight: bold;
      }

      .form-group {
        margin-bottom: 25px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--text-primary);
        font-size: 0.95rem;
      }

      input,
      textarea,
      select {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid var(--border-color);
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: #fff;
      }

      input:focus,
      textarea:focus,
      select:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        transform: translateY(-1px);
      }

      input[type="file"] {
        padding: 10px;
        background: var(--bg-primary);
        border-style: dashed;
      }

      input[type="file"]:hover {
        background: var(--bg-secondary);
      }

      .btn {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--primary-dark) 100%
        );
        color: white;
        padding: 14px 28px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        margin-right: 15px;
        margin-bottom: 10px;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
        position: relative;
        overflow: hidden;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .btn:hover::before {
        left: 100%;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .btn:active {
        transform: translateY(0);
      }

      .btn:disabled {
        background: var(--bg-secondary);
        color: var(--text-secondary);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .btn:disabled::before {
        display: none;
      }

      .btn-success {
        background: linear-gradient(
          135deg,
          var(--success-color) 0%,
          #38a169 100%
        );
      }

      .btn-warning {
        background: linear-gradient(
          135deg,
          var(--warning-color) 0%,
          #dd6b20 100%
        );
      }

      .btn-secondary {
        background: linear-gradient(
          135deg,
          var(--text-secondary) 0%,
          #4a5568 100%
        );
      }

      .status {
        padding: 20px;
        border-radius: 12px;
        margin: 20px 0;
        border-left: 5px solid;
        box-shadow: var(--shadow-sm);
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .status.success {
        background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%);
        color: #22543d;
        border-left-color: var(--success-color);
      }

      .status.error {
        background: linear-gradient(135deg, #fff5f5 0%, #fed7d7 100%);
        color: #742a2a;
        border-left-color: var(--error-color);
      }

      .status.info {
        background: linear-gradient(135deg, #ebf8ff 0%, #bee3f8 100%);
        color: #2c5282;
        border-left-color: var(--info-color);
      }

      .status.warning {
        background: linear-gradient(135deg, #fffaf0 0%, #fbd38d 100%);
        color: #744210;
        border-left-color: var(--warning-color);
      }

      .status-icon {
        display: inline-block;
        margin-right: 10px;
        font-size: 1.2rem;
      }

      .status.success .status-icon::before {
        content: "âœ…";
      }
      .status.error .status-icon::before {
        content: "âŒ";
      }
      .status.info .status-icon::before {
        content: "â„¹ï¸";
      }
      .status.warning .status-icon::before {
        content: "âš ï¸";
      }

      .audio-player {
        margin: 20px 0;
        padding: 20px;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        border-radius: 12px;
        border: 1px solid var(--border-color);
      }

      .audio-player h4 {
        margin-bottom: 15px;
        color: var(--text-primary);
        display: flex;
        align-items: center;
      }

      .audio-player h4::before {
        content: "ğŸµ";
        margin-right: 8px;
      }

      .audio-player audio {
        width: 100%;
        height: 50px;
        border-radius: 8px;
      }

      .progress {
        width: 100%;
        height: 8px;
        background: var(--bg-secondary);
        border-radius: 10px;
        overflow: hidden;
        margin: 15px 0;
        position: relative;
      }

      .progress::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--success-color)
        );
        border-radius: 10px;
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          width: 0%;
        }
        50% {
          width: 70%;
        }
        100% {
          width: 0%;
        }
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--success-color)
        );
        transition: width 0.3s ease;
        border-radius: 10px;
        position: relative;
        overflow: hidden;
      }

      .progress-bar::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        animation: progressShine 2s infinite;
      }

      @keyframes progressShine {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      .loading-spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid var(--border-color);
        border-radius: 50%;
        border-top-color: var(--primary-color);
        animation: spin 1s ease-in-out infinite;
        margin-right: 10px;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .info-card {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: var(--shadow-sm);
        border-left: 4px solid var(--primary-color);
        transition: transform 0.2s ease;
      }

      .info-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .info-card h3 {
        color: var(--primary-color);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
      }

      .info-card h3::before {
        content: "ğŸ“‹";
        margin-right: 8px;
      }

      .floating-action {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 60px;
        height: 60px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-dark)
        );
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        box-shadow: var(--shadow-lg);
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 1000;
      }

      .floating-action:hover {
        transform: scale(1.1);
        box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 2000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(5px);
      }

      .modal-content {
        background-color: white;
        margin: 5% auto;
        padding: 30px;
        border-radius: 20px;
        width: 90%;
        max-width: 600px;
        box-shadow: var(--shadow-lg);
        animation: modalSlideIn 0.3s ease;
      }

      @keyframes modalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-50px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .close {
        color: var(--text-secondary);
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s ease;
      }

      .close:hover {
        color: var(--error-color);
      }

      .feature-highlight {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 20px;
        margin: 30px 0;
        text-align: center;
      }

      .feature-highlight h2 {
        margin-bottom: 15px;
        font-size: 1.8rem;
      }

      .feature-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .feature-item {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 10px;
        backdrop-filter: blur(10px);
      }

      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: white;
        padding: 15px 20px;
        border-radius: 10px;
        box-shadow: var(--shadow-lg);
        z-index: 3000;
        transform: translateX(400px);
        transition: transform 0.3s ease;
      }

      .toast.show {
        transform: translateX(0);
      }

      .toast.success {
        border-left: 4px solid var(--success-color);
      }

      .toast.error {
        border-left: 4px solid var(--error-color);
      }

      .toast.info {
        border-left: 4px solid var(--info-color);
      }

      .layout-footer {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(248, 250, 252, 0.95) 100%
        );
        backdrop-filter: blur(10px);
        border-top: 1px solid var(--border-color);
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        padding: 0;
      }

      .footer-content {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        padding: 15px 20px;
        max-width: 1200px;
        margin: 0 auto;
      }

      .footer-content .btn {
        font-size: 0.9rem;
        padding: 10px 20px;
        margin: 0;
        white-space: nowrap;
      }

      .footer-spacer {
        height: 80px;
        flex-shrink: 0;
      }

      /* ç¢ºä¿ä¸»å®¹å™¨ä¸æœƒè¢«åº•éƒ¨å·¥å…·æ¬„é®æ“‹ */
      .main-container {
        padding-bottom: 100px; /* ç‚ºåº•éƒ¨å·¥å…·æ¬„ç•™å‡ºé¡å¤–ç©ºé–“ */
      }

      /* èª¿æ•´æµ®å‹•æŒ‰éˆ•ä½ç½®ï¼Œé¿å…èˆ‡åº•éƒ¨å·¥å…·æ¬„é‡ç–Š */
      .floating-action {
        bottom: 100px; /* èª¿æ•´åˆ°åº•éƒ¨å·¥å…·æ¬„ä¸Šæ–¹ */
      }

      @media (max-width: 768px) {
        .main-container {
          padding: 10px;
          padding-bottom: 120px; /* ç§»å‹•ç«¯éœ€è¦æ›´å¤šç©ºé–“ */
        }

        .container {
          padding: 20px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .progress-indicator {
          flex-direction: column;
          align-items: center;
        }

        .progress-step {
          margin: 10px 0;
        }

        .progress-step::after {
          display: none;
        }

        .card-grid {
          grid-template-columns: 1fr;
        }

        .floating-action {
          bottom: 110px; /* ç§»å‹•ç«¯èª¿æ•´ä½ç½® */
          right: 20px;
          width: 50px;
          height: 50px;
          font-size: 20px;
        }

        .footer-content {
          flex-direction: row;
          flex-wrap: wrap;
          gap: 10px;
          padding: 12px 15px;
        }

        .footer-content .btn {
          font-size: 0.8rem;
          padding: 8px 16px;
          flex: 1;
          min-width: 80px;
        }

        .footer-spacer {
          height: 90px; /* ç§»å‹•ç«¯å¢åŠ é«˜åº¦ */
        }
      }

      @media (max-width: 480px) {
        .footer-content {
          gap: 8px;
          padding: 10px 12px;
        }

        .footer-content .btn {
          font-size: 0.75rem;
          padding: 6px 12px;
        }

        .main-container {
          padding-bottom: 140px;
        }

        .floating-action {
          bottom: 120px;
        }

        .footer-spacer {
          height: 100px;
        }
      }
    </style>
  </head>
  <body>
    <div class="main-container">
      <!-- é é¢æ¨™é¡Œ -->
      <div class="header">
        <h1>ğŸ™ï¸ AI èªéŸ³å…‹éš†ç³»çµ±</h1>
        <p>
          é«”é©—æœ€å…ˆé€²çš„èªéŸ³å…‹éš†æŠ€è¡“ï¼Œåªéœ€å››å€‹ç°¡å–®æ­¥é©Ÿå³å¯å‰µå»ºæ‚¨çš„å°ˆå±¬AIèªéŸ³åŠ©æ‰‹
        </p>
      </div>

      <!-- é€²åº¦æŒ‡ç¤ºå™¨ -->
      <div class="progress-indicator">
        <div class="progress-step active" id="progress1">
          <div class="step-circle">1</div>
          <div class="step-label">ç”Ÿæˆæ–‡å­—</div>
        </div>
        <div class="progress-step" id="progress2">
          <div class="step-circle">2</div>
          <div class="step-label">ä¸Šå‚³èªéŸ³</div>
        </div>
        <div class="progress-step" id="progress3">
          <div class="step-circle">3</div>
          <div class="step-label">æ¸¬è©¦æ•ˆæœ</div>
        </div>
        <div class="progress-step" id="progress4">
          <div class="step-circle">4</div>
          <div class="step-label">AIå°è©±</div>
        </div>
      </div>

      <!-- åŠŸèƒ½äº®é» -->
      <div class="feature-highlight">
        <h2>ğŸš€ ç³»çµ±ç‰¹è‰²</h2>
        <div class="feature-list">
          <div class="feature-item">
            <strong>ğŸ¯ é«˜ç²¾åº¦å…‹éš†</strong><br />
            ä½¿ç”¨GPT-SoVITS v4æŠ€è¡“
          </div>
          <div class="feature-item">
            <strong>ğŸ¤– AIæ™ºèƒ½åˆ†æ</strong><br />
            AIæƒ…æ„Ÿç†è§£
          </div>
          <div class="feature-item">
            <strong>âš¡ å¿«é€Ÿè™•ç†</strong><br />
            è‡ªå‹•é™å™ªèˆ‡éŸ³é »å„ªåŒ–
          </div>
          <div class="feature-item">
            <strong>ğŸ¨ ç°¡å–®æ˜“ç”¨</strong><br />
            ç›´è§€çš„æ“ä½œç•Œé¢
          </div>
        </div>
      </div>

      <!-- æ­¥é©Ÿ1ï¼šç”Ÿæˆé–±è®€æ–‡å­— -->
      <div class="container">
        <div class="step active" id="step1">
          <div class="step-title">æ­¥é©Ÿ 1ï¼šç”Ÿæˆé–±è®€æ–‡å­—</div>
          <p>ç³»çµ±å°‡ç‚ºæ‚¨ç”Ÿæˆç´„60ç§’çš„é–±è®€æ–‡å­—ï¼Œè«‹æº–å‚™å¥½æ¸…æ¥šåœ°æœ—è®€é€™äº›å…§å®¹ã€‚</p>

          <div class="form-group">
            <label for="duration">é æœŸæœ—è®€æ™‚é•·ï¼ˆç§’ï¼‰ï¼š</label>
            <input type="number" id="duration" value="60" min="30" max="120" />
          </div>

          <button class="btn" onclick="generateReadingText()">
            <span id="generateTextBtn">ğŸ¯ ç”Ÿæˆé–±è®€æ–‡å­—</span>
          </button>

          <div id="readingTextResult" style="display: none">
            <div class="reading-text" id="readingTextContent"></div>
            <div class="tips-card">
              <h4>æœ—è®€æç¤º</h4>
              <ul>
                <li>ä¿æŒè‡ªç„¶çš„èªèª¿å’Œèªé€Ÿ</li>
                <li>ç™¼éŸ³æ¸…æ™°ï¼Œé¿å…å£éŸ³éé‡</li>
                <li>åœ¨å®‰éœçš„ç’°å¢ƒä¸­éŒ„è£½</li>
                <li>ä½¿ç”¨é«˜è³ªé‡çš„éº¥å…‹é¢¨</li>
                <li>å»ºè­°éŒ„è£½æ™‚é•·60-90ç§’</li>
              </ul>
            </div>
            <button class="btn btn-success" onclick="nextStep(2)">
              âœ… ç¹¼çºŒåˆ°ä¸‹ä¸€æ­¥
            </button>
          </div>
        </div>
      </div>

      <!-- æ­¥é©Ÿ2ï¼šä¸Šå‚³èªéŸ³æª”æ¡ˆ -->
      <div class="container">
        <div class="step" id="step2">
          <div class="step-title">æ­¥é©Ÿ 2ï¼šä¸Šå‚³èªéŸ³æª”æ¡ˆ</div>
          <p>è«‹ä¸Šå‚³æ‚¨æœ—è®€ä¸Šè¿°æ–‡å­—çš„WAVæ ¼å¼éŸ³é »æ–‡ä»¶ã€‚</p>

          <div class="form-group">
            <label for="staffCode">å®¢æœä»£è™Ÿï¼š</label>
            <input
              type="text"
              id="staffCode"
              placeholder="è«‹è¼¸å…¥å®¢æœä»£è™Ÿï¼Œä¾‹å¦‚ï¼šCS001"
            />
          </div>

          <div class="form-group">
            <label for="audioFile">éŸ³é »æ–‡ä»¶ï¼ˆWAVæ ¼å¼ï¼‰ï¼š</label>
            <input
              type="file"
              id="audioFile"
              accept=".wav"
              onchange="validateAudioFile()"
            />
          </div>

          <div class="form-group">
            <label for="referenceText">åƒè€ƒæ–‡å­—ï¼š</label>
            <textarea
              id="referenceText"
              rows="4"
              placeholder="è«‹è¼¸å…¥æ‚¨æœ—è®€çš„æ–‡å­—å…§å®¹"
            ></textarea>
          </div>

          <button
            class="btn"
            onclick="uploadVoiceSample()"
            id="uploadBtn"
            disabled
          >
            <span id="uploadBtnText">ğŸ“¤ ä¸Šå‚³ä¸¦è™•ç†èªéŸ³</span>
          </button>

          <div id="uploadProgress" style="display: none">
            <div class="progress">
              <div class="progress-bar" id="progressBar"></div>
            </div>
            <div id="progressText">è™•ç†ä¸­...</div>
          </div>

          <div id="uploadResult"></div>
        </div>
      </div>

      <!-- æ­¥é©Ÿ3ï¼šæ¸¬è©¦èªéŸ³ç”Ÿæˆ -->
      <div class="container">
        <div class="step" id="step3">
          <div class="step-title">æ­¥é©Ÿ 3ï¼šæ¸¬è©¦èªéŸ³ç”Ÿæˆ</div>
          <p>èªéŸ³æ¨¡å‹è¨­ç½®å®Œæˆå¾Œï¼Œæ‚¨å¯ä»¥æ¸¬è©¦èªéŸ³ç”Ÿæˆæ•ˆæœã€‚</p>

          <div class="form-group">
            <label for="testText">æ¸¬è©¦æ–‡å­—ï¼š</label>
            <textarea
              id="testText"
              rows="3"
              placeholder="è«‹è¼¸å…¥è¦è½‰æ›ç‚ºèªéŸ³çš„æ–‡å­—"
            >
æ‚¨å¥½ï¼Œæˆ‘æ˜¯AIå®¢æœåŠ©æ‰‹ï¼Œå¾ˆé«˜èˆˆç‚ºæ‚¨æœå‹™ã€‚è«‹å•æœ‰ä»€éº¼å¯ä»¥å¹«åŠ©æ‚¨çš„å—ï¼Ÿ</textarea
            >
          </div>

          <button
            class="btn"
            onclick="testVoiceGeneration()"
            id="testBtn"
            disabled
          >
            ğŸµ ç”Ÿæˆæ¸¬è©¦èªéŸ³
          </button>

          <div id="testResult"></div>
        </div>
      </div>

      <!-- æ­¥é©Ÿ4ï¼šAIå°è©±æ¸¬è©¦ -->
      <div class="container">
        <div class="step" id="step4">
          <div class="step-title">æ­¥é©Ÿ 4ï¼šAIå°è©±æ¸¬è©¦</div>
          <p>
            è¼¸å…¥ç”¨æˆ¶å•é¡Œï¼Œç³»çµ±å°‡ä½¿ç”¨DeepSeek
            AIåˆ†æä¸¦ç”Ÿæˆå›æ‡‰ï¼Œç„¶å¾Œç”¨æ‚¨çš„è²éŸ³æœ—è®€å‡ºä¾†ã€‚
          </p>

          <div class="form-group">
            <label for="userInput">ç”¨æˆ¶è¼¸å…¥ï¼š</label>
            <textarea
              id="userInput"
              rows="3"
              placeholder="è«‹è¼¸å…¥ç”¨æˆ¶çš„å•é¡Œæˆ–éœ€æ±‚"
            >
æˆ‘æœ€è¿‘æ„Ÿåˆ°å¾ˆç„¦æ…®ï¼Œä¸çŸ¥é“è©²æ€éº¼è¾¦ï¼Œèƒ½çµ¦æˆ‘ä¸€äº›å»ºè­°å—ï¼Ÿ</textarea
            >
          </div>

          <button
            class="btn"
            onclick="generateAIResponse()"
            id="aiBtn"
            disabled
          >
            ğŸ¤– ç”ŸæˆAIå›æ‡‰èªéŸ³
          </button>

          <div id="aiResult"></div>
        </div>
      </div>

      <!-- æµ®å‹•æ“ä½œæŒ‰éˆ• -->
      <div class="floating-action" onclick="scrollToTop()" title="å›åˆ°é ‚éƒ¨">
        â†‘
      </div>

      <!-- åº•éƒ¨æ“ä½œæ¬„ -->
      <footer class="layout-footer">
        <div class="footer-content">
          <button class="btn btn-secondary" onclick="resetAll()">
            ğŸ”„ é‡ç½®
          </button>
          <button
            class="btn"
            onclick="document.getElementById('helpModal').style.display = 'block'"
          >
            â“ å¹«åŠ©
          </button>
          <button class="btn btn-success" onclick="saveProgress()">
            ğŸ’¾ ä¿å­˜é€²åº¦
          </button>
        </div>
      </footer>

      <!-- ç‚ºåº•éƒ¨æ“ä½œæ¬„ç•™å‡ºç©ºé–“ -->
      <div class="footer-spacer"></div>

      <!-- Toast é€šçŸ¥ -->
      <div id="toast" class="toast">
        <span id="toastMessage"></span>
      </div>

      <!-- å¹«åŠ©æ¨¡æ…‹æ¡† -->
      <div id="helpModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeModal()">&times;</span>
          <h2>ğŸ”§ ä½¿ç”¨èªªæ˜</h2>
          <div class="card-grid">
            <div class="info-card">
              <h3>æ­¥é©Ÿ1ï¼šç”Ÿæˆæ–‡å­—</h3>
              <p>ç³»çµ±æœƒè‡ªå‹•ç”Ÿæˆé©åˆèªéŸ³è¨“ç·´çš„æ–‡å­—å…§å®¹ï¼Œå»ºè­°æœ—è®€æ™‚é•·60-90ç§’ã€‚</p>
            </div>
            <div class="info-card">
              <h3>æ­¥é©Ÿ2ï¼šä¸Šå‚³èªéŸ³</h3>
              <p>ä¸Šå‚³WAVæ ¼å¼çš„éŸ³é »æ–‡ä»¶ï¼Œç³»çµ±æœƒè‡ªå‹•é€²è¡Œåˆ‡åˆ†ã€é™å™ªç­‰è™•ç†ã€‚</p>
            </div>
            <div class="info-card">
              <h3>æ­¥é©Ÿ3ï¼šæ¸¬è©¦æ•ˆæœ</h3>
              <p>ä½¿ç”¨æ¸¬è©¦æ–‡å­—é©—è­‰èªéŸ³å…‹éš†çš„æ•ˆæœå’Œè³ªé‡ã€‚</p>
            </div>
            <div class="info-card">
              <h3>æ­¥é©Ÿ4ï¼šAIå°è©±</h3>
              <p>é«”é©—AIåˆ†æç”¨æˆ¶è¼¸å…¥ä¸¦ç”¨æ‚¨çš„è²éŸ³å›æ‡‰çš„å®Œæ•´æµç¨‹ã€‚</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let currentStep = 1;
      let staffCode = "";
      let readingText = "";
      let isProcessing = false;

      // é¡¯ç¤ºToasté€šçŸ¥
      function showToast(message, type = "info") {
        const toast = document.getElementById("toast");
        const toastMessage = document.getElementById("toastMessage");

        toastMessage.textContent = message;
        toast.className = `toast ${type}`;
        toast.classList.add("show");

        setTimeout(() => {
          toast.classList.remove("show");
        }, 3000);
      }

      // æ»¾å‹•åˆ°é ‚éƒ¨
      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }

      // é—œé–‰æ¨¡æ…‹æ¡†
      function closeModal() {
        document.getElementById("helpModal").style.display = "none";
      }

      // æ›´æ–°é€²åº¦æŒ‡ç¤ºå™¨
      function updateProgress(step) {
        // é‡ç½®æ‰€æœ‰æ­¥é©Ÿ
        for (let i = 1; i <= 4; i++) {
          const progressStep = document.getElementById(`progress${i}`);
          progressStep.classList.remove("active", "completed");

          if (i < step) {
            progressStep.classList.add("completed");
          } else if (i === step) {
            progressStep.classList.add("active");
          }
        }
      }

      // æ·»åŠ åŠ è¼‰å‹•ç•«
      function setButtonLoading(buttonId, loading, originalText = "") {
        const button = document.getElementById(buttonId);
        const textElement = button.querySelector("span") || button;

        if (loading) {
          button.disabled = true;
          textElement.innerHTML =
            '<span class="loading-spinner"></span>è™•ç†ä¸­...';
        } else {
          button.disabled = false;
          textElement.innerHTML = originalText;
        }
      }

      function generateReadingText() {
        if (isProcessing) return;
        isProcessing = true;

        const duration = document.getElementById("duration").value;
        setButtonLoading("generateTextBtn", true);

        fetch(`/voice_clone/generate_reading_text?duration=${duration}`)
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "success") {
              readingText = data.reading_text;
              document.getElementById("readingTextContent").textContent =
                data.reading_text;
              document.getElementById("readingTextResult").style.display =
                "block";
              document.getElementById("referenceText").value =
                data.reading_text;
              showToast("é–±è®€æ–‡å­—ç”ŸæˆæˆåŠŸï¼", "success");
            } else {
              showToast("ç”Ÿæˆé–±è®€æ–‡å­—å¤±æ•—ï¼š" + data.message, "error");
            }
          })
          .catch((error) => {
            showToast("è«‹æ±‚å¤±æ•—ï¼š" + error.message, "error");
          })
          .finally(() => {
            isProcessing = false;
            setButtonLoading("generateTextBtn", false, "ğŸ¯ ç”Ÿæˆé–±è®€æ–‡å­—");
          });
      }

      function nextStep(step) {
        // æ›´æ–°æ­¥é©Ÿç‹€æ…‹
        document
          .getElementById(`step${currentStep}`)
          .classList.remove("active");
        document
          .getElementById(`step${currentStep}`)
          .classList.add("completed");
        document.getElementById(`step${step}`).classList.add("active");

        // æ›´æ–°é€²åº¦æŒ‡ç¤ºå™¨
        updateProgress(step);

        currentStep = step;

        // å¹³æ»‘æ»¾å‹•åˆ°æ–°æ­¥é©Ÿ
        document.getElementById(`step${step}`).scrollIntoView({
          behavior: "smooth",
          block: "center",
        });

        showToast(`å·²é€²å…¥æ­¥é©Ÿ ${step}`, "info");
      }

      function validateAudioFile() {
        const audioFile = document.getElementById("audioFile").files[0];
        const staffCodeInput = document.getElementById("staffCode").value;
        const uploadBtn = document.getElementById("uploadBtn");

        if (audioFile && staffCodeInput.trim()) {
          uploadBtn.disabled = false;
        } else {
          uploadBtn.disabled = true;
        }
      }

      function uploadVoiceSample() {
        if (isProcessing) return;

        const audioFile = document.getElementById("audioFile").files[0];
        const staffCodeInput = document.getElementById("staffCode").value;
        const referenceText = document.getElementById("referenceText").value;

        if (!audioFile || !staffCodeInput || !referenceText) {
          showToast("è«‹å¡«å¯«æ‰€æœ‰å¿…è¦ä¿¡æ¯", "error");
          return;
        }

        if (!audioFile.name.toLowerCase().endsWith(".wav")) {
          showToast("è«‹ä¸Šå‚³WAVæ ¼å¼çš„éŸ³é »æ–‡ä»¶", "error");
          return;
        }

        isProcessing = true;
        staffCode = staffCodeInput;

        const formData = new FormData();
        formData.append("audio_file", audioFile);
        formData.append("staff_code", staffCode);
        formData.append("reference_text", referenceText);

        document.getElementById("uploadProgress").style.display = "block";
        setButtonLoading("uploadBtnText", true);

        // æ¨¡æ“¬é€²åº¦æ›´æ–°
        let progress = 0;
        const progressInterval = setInterval(() => {
          progress += Math.random() * 15;
          if (progress > 90) progress = 90;
          updateProgress(progress, "è™•ç†ä¸­...");
        }, 500);

        fetch("/voice_clone/upload_voice_sample", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            clearInterval(progressInterval);
            updateProgress(100, "è™•ç†å®Œæˆï¼");

            setTimeout(() => {
              document.getElementById("uploadProgress").style.display = "none";

              if (data.status === "success") {
                showUploadResult(
                  "success",
                  "èªéŸ³æ¨£æœ¬ä¸Šå‚³æˆåŠŸï¼æ¨¡å‹å·²æº–å‚™å°±ç·’ã€‚",
                  data
                );
                document.getElementById("testBtn").disabled = false;
                document.getElementById("aiBtn").disabled = false;
                showToast("èªéŸ³æ¨¡å‹è¨­ç½®å®Œæˆï¼", "success");
                nextStep(3);
              } else {
                showUploadResult("error", "ä¸Šå‚³å¤±æ•—ï¼š" + data.message);
                showToast("ä¸Šå‚³å¤±æ•—ï¼š" + data.message, "error");
              }
            }, 1000);
          })
          .catch((error) => {
            clearInterval(progressInterval);
            document.getElementById("uploadProgress").style.display = "none";
            showUploadResult("error", "è«‹æ±‚å¤±æ•—ï¼š" + error.message);
            showToast("è«‹æ±‚å¤±æ•—ï¼š" + error.message, "error");
          })
          .finally(() => {
            isProcessing = false;
            setButtonLoading("uploadBtnText", false, "ğŸ“¤ ä¸Šå‚³ä¸¦è™•ç†èªéŸ³");
          });
      }

      function testVoiceGeneration() {
        if (isProcessing) return;

        const testText = document.getElementById("testText").value;

        if (!testText.trim()) {
          showToast("è«‹è¼¸å…¥æ¸¬è©¦æ–‡å­—", "error");
          return;
        }

        isProcessing = true;
        const testBtn = document.getElementById("testBtn");
        const originalText = testBtn.innerHTML;
        testBtn.innerHTML = '<span class="loading-spinner"></span>ç”Ÿæˆä¸­...';
        testBtn.disabled = true;

        fetch("/voice_clone/test_voice_generation", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            test_text: testText,
            staff_code: staffCode,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "success") {
              showTestResult("success", "æ¸¬è©¦èªéŸ³ç”ŸæˆæˆåŠŸï¼", data);
              showToast("æ¸¬è©¦èªéŸ³ç”ŸæˆæˆåŠŸï¼", "success");
              nextStep(4);
            } else {
              showTestResult("error", "ç”Ÿæˆå¤±æ•—ï¼š" + data.message);
              showToast("ç”Ÿæˆå¤±æ•—ï¼š" + data.message, "error");
            }
          })
          .catch((error) => {
            showTestResult("error", "è«‹æ±‚å¤±æ•—ï¼š" + error.message);
            showToast("è«‹æ±‚å¤±æ•—ï¼š" + error.message, "error");
          })
          .finally(() => {
            isProcessing = false;
            testBtn.innerHTML = originalText;
            testBtn.disabled = false;
          });
      }

      function generateAIResponse() {
        if (isProcessing) return;

        const userInput = document.getElementById("userInput").value;

        if (!userInput.trim()) {
          showToast("è«‹è¼¸å…¥ç”¨æˆ¶å•é¡Œ", "error");
          return;
        }

        isProcessing = true;
        const aiBtn = document.getElementById("aiBtn");
        const originalText = aiBtn.innerHTML;
        aiBtn.innerHTML = '<span class="loading-spinner"></span>AIåˆ†æä¸­...';
        aiBtn.disabled = true;

        fetch("/voice_clone/generate_response_voice", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            user_input: userInput,
            staff_code: staffCode,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "success") {
              showAIResult("success", "AIå›æ‡‰ç”ŸæˆæˆåŠŸï¼", data);
              showToast("AIèªéŸ³å›æ‡‰ç”Ÿæˆå®Œæˆï¼", "success");
            } else {
              showAIResult("error", "ç”Ÿæˆå¤±æ•—ï¼š" + data.message);
              showToast("ç”Ÿæˆå¤±æ•—ï¼š" + data.message, "error");
            }
          })
          .catch((error) => {
            showAIResult("error", "è«‹æ±‚å¤±æ•—ï¼š" + error.message);
            showToast("è«‹æ±‚å¤±æ•—ï¼š" + error.message, "error");
          })
          .finally(() => {
            isProcessing = false;
            aiBtn.innerHTML = originalText;
            aiBtn.disabled = false;
          });
      }

      function updateProgress(percent, text) {
        document.getElementById("progressBar").style.width = percent + "%";
        document.getElementById("progressText").textContent = text;
      }

      function showStatus(type, message) {
        // é€šç”¨ç‹€æ…‹é¡¯ç¤ºå‡½æ•¸
        console.log(`${type}: ${message}`);
      }

      function showUploadResult(type, message, data = null) {
        const resultDiv = document.getElementById("uploadResult");
        resultDiv.innerHTML = `
                <div class="status ${type}">
                    <span class="status-icon"></span>
                    <strong>${message}</strong>
                    ${
                      data
                        ? `
                        <div style="margin-top: 15px;">
                            <div class="info-card">
                                <h3>è™•ç†è©³æƒ…</h3>
                                <p><strong>è™•ç†æ­¥é©Ÿï¼š</strong>${data.processed_info.processing_steps.join(
                                  " â†’ "
                                )}</p>
                                <p><strong>æ¨¡å‹ç‹€æ…‹ï¼š</strong><span style="color: var(--success-color); font-weight: bold;">${
                                  data.processed_info.model_status
                                }</span></p>
                                <p><strong>å®¢æœä»£è™Ÿï¼š</strong>${
                                  data.staff_code
                                }</p>
                                <p><strong>åŸå§‹æª”åï¼š</strong>${
                                  data.processed_info.original_filename
                                }</p>
                            </div>
                        </div>
                    `
                        : ""
                    }
                </div>
            `;
      }

      function showTestResult(type, message, data = null) {
        const resultDiv = document.getElementById("testResult");
        resultDiv.innerHTML = `
                <div class="status ${type}">
                    <span class="status-icon"></span>
                    <strong>${message}</strong>
                    ${
                      data && data.audio_url
                        ? `
                        <div class="audio-player">
                            <h4>ğŸµ æ¸¬è©¦èªéŸ³çµæœ</h4>
                            <audio controls preload="auto">
                                <source src="${data.audio_url}" type="audio/wav">
                                æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æŒéŸ³é »æ’­æ”¾ã€‚
                            </audio>
                            <div style="margin-top: 10px;">
                                <p><strong>æ¸¬è©¦æ–‡å­—ï¼š</strong>${data.test_text}</p>
                                <p><strong>å®¢æœä»£è™Ÿï¼š</strong>${data.staff_code}</p>
                            </div>
                        </div>
                    `
                        : ""
                    }
                </div>
            `;
      }

      function showAIResult(type, message, data = null) {
        const resultDiv = document.getElementById("aiResult");
        resultDiv.innerHTML = `
                <div class="status ${type}">
                    <span class="status-icon"></span>
                    <strong>${message}</strong>
                    ${
                      data
                        ? `
                        <div style="margin-top: 20px;">
                            <div class="card-grid">
                                <div class="info-card">
                                    <h3>ğŸ¤– AIåˆ†æçµæœ</h3>
                                    <p><strong>æƒ…æ„Ÿåˆ†æï¼š</strong>
                                        <span style="color: ${getSentimentColor(
                                          data.ai_analysis.sentiment
                                        )}; font-weight: bold;">
                                            ${data.ai_analysis.sentiment}
                                        </span>
                                    </p>
                                    <p><strong>å›æ‡‰å…§å®¹ï¼š</strong></p>
                                    <div style="background: var(--bg-primary); padding: 15px; border-radius: 8px; margin-top: 10px;">
                                        ${data.ai_analysis.response_text}
                                    </div>
                                </div>
                                ${
                                  data.voice_output.audio_url
                                    ? `
                                    <div class="info-card">
                                        <h3>ğŸµ èªéŸ³å›æ‡‰</h3>
                                        <div class="audio-player">
                                            <audio controls preload="auto">
                                                <source src="${data.voice_output.audio_url}" type="audio/wav">
                                                æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æŒéŸ³é »æ’­æ”¾ã€‚
                                            </audio>
                                        </div>
                                        <p style="margin-top: 10px;"><strong>å®¢æœä»£è™Ÿï¼š</strong>${data.voice_output.staff_code}</p>
                                    </div>
                                `
                                    : ""
                                }
                            </div>
                        </div>
                    `
                        : ""
                    }
                </div>
            `;
      }

      // æ ¹æ“šæƒ…æ„Ÿåˆ†æçµæœè¿”å›å°æ‡‰é¡è‰²
      function getSentimentColor(sentiment) {
        switch (sentiment) {
          case "æ­£é¢":
            return "var(--success-color)";
          case "è² é¢":
            return "var(--error-color)";
          case "ä¸­æ€§":
            return "var(--info-color)";
          default:
            return "var(--text-secondary)";
        }
      }

      // ç›£è½å®¢æœä»£è™Ÿè¼¸å…¥
      document
        .getElementById("staffCode")
        .addEventListener("input", validateAudioFile);

      // é é¢åŠ è¼‰å®Œæˆå¾Œçš„åˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", function () {
        // æ·»åŠ éµç›¤å¿«æ·éµ
        document.addEventListener("keydown", function (e) {
          // ESC é—œé–‰æ¨¡æ…‹æ¡†
          if (e.key === "Escape") {
            closeModal();
          }

          // F1 é¡¯ç¤ºå¹«åŠ©
          if (e.key === "F1") {
            e.preventDefault();
            document.getElementById("helpModal").style.display = "block";
          }
        });

        // æ·»åŠ æ–‡ä»¶æ‹–æ‹½åŠŸèƒ½
        const audioFileInput = document.getElementById("audioFile");
        const audioFileContainer = audioFileInput.parentElement;

        ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
          audioFileContainer.addEventListener(
            eventName,
            preventDefaults,
            false
          );
        });

        function preventDefaults(e) {
          e.preventDefault();
          e.stopPropagation();
        }

        ["dragenter", "dragover"].forEach((eventName) => {
          audioFileContainer.addEventListener(eventName, highlight, false);
        });

        ["dragleave", "drop"].forEach((eventName) => {
          audioFileContainer.addEventListener(eventName, unhighlight, false);
        });

        function highlight(e) {
          audioFileContainer.style.background = "var(--primary-color)";
          audioFileContainer.style.color = "white";
        }

        function unhighlight(e) {
          audioFileContainer.style.background = "";
          audioFileContainer.style.color = "";
        }

        audioFileContainer.addEventListener("drop", handleDrop, false);

        function handleDrop(e) {
          const dt = e.dataTransfer;
          const files = dt.files;

          if (files.length > 0) {
            const file = files[0];
            if (
              file.type === "audio/wav" ||
              file.name.toLowerCase().endsWith(".wav")
            ) {
              audioFileInput.files = files;
              validateAudioFile();
              showToast("æ–‡ä»¶æ‹–æ‹½æˆåŠŸï¼", "success");
            } else {
              showToast("è«‹æ‹–æ‹½WAVæ ¼å¼çš„éŸ³é »æ–‡ä»¶", "error");
            }
          }
        }

        // æ·»åŠ éŸ³é »æ’­æ”¾äº‹ä»¶ç›£è½
        document.addEventListener(
          "play",
          function (e) {
            if (e.target.tagName === "AUDIO") {
              // æš«åœå…¶ä»–æ­£åœ¨æ’­æ”¾çš„éŸ³é »
              document.querySelectorAll("audio").forEach((audio) => {
                if (audio !== e.target) {
                  audio.pause();
                }
              });
            }
          },
          true
        );

        // æ·»åŠ é€²åº¦ä¿å­˜åŠŸèƒ½
        loadProgress();
      });

      // ä¿å­˜é€²åº¦åˆ°æœ¬åœ°å­˜å„²
      function saveProgress() {
        const progress = {
          currentStep,
          staffCode,
          readingText,
          timestamp: Date.now(),
        };
        localStorage.setItem("voiceCloneProgress", JSON.stringify(progress));
      }

      // å¾æœ¬åœ°å­˜å„²åŠ è¼‰é€²åº¦
      function loadProgress() {
        const saved = localStorage.getItem("voiceCloneProgress");
        if (saved) {
          try {
            const progress = JSON.parse(saved);
            // æª¢æŸ¥æ˜¯å¦æ˜¯ä»Šå¤©çš„é€²åº¦ï¼ˆ24å°æ™‚å…§ï¼‰
            if (Date.now() - progress.timestamp < 24 * 60 * 60 * 1000) {
              if (progress.staffCode) {
                document.getElementById("staffCode").value = progress.staffCode;
                staffCode = progress.staffCode;
              }
              if (progress.readingText) {
                document.getElementById("referenceText").value =
                  progress.readingText;
                readingText = progress.readingText;
              }
              showToast("å·²æ¢å¾©ä¸Šæ¬¡çš„é€²åº¦", "info");
            }
          } catch (e) {
            console.log("ç„¡æ³•åŠ è¼‰ä¿å­˜çš„é€²åº¦");
          }
        }
      }

      // é‡ç½®æ‰€æœ‰æ•¸æ“š
      function resetAll() {
        if (confirm("ç¢ºå®šè¦é‡ç½®æ‰€æœ‰æ•¸æ“šå—ï¼Ÿé€™å°‡æ¸…é™¤ç•¶å‰çš„é€²åº¦ã€‚")) {
          currentStep = 1;
          staffCode = "";
          readingText = "";
          isProcessing = false;

          // é‡ç½®è¡¨å–®
          document.getElementById("duration").value = 60;
          document.getElementById("staffCode").value = "";
          document.getElementById("referenceText").value = "";
          document.getElementById("audioFile").value = "";
          document.getElementById("testText").value =
            "æ‚¨å¥½ï¼Œæˆ‘æ˜¯AIå®¢æœåŠ©æ‰‹ï¼Œå¾ˆé«˜èˆˆç‚ºæ‚¨æœå‹™ã€‚è«‹å•æœ‰ä»€éº¼å¯ä»¥å¹«åŠ©æ‚¨çš„å—ï¼Ÿ";
          document.getElementById("userInput").value =
            "æˆ‘æœ€è¿‘æ„Ÿåˆ°å¾ˆç„¦æ…®ï¼Œä¸çŸ¥é“è©²æ€éº¼è¾¦ï¼Œèƒ½çµ¦æˆ‘ä¸€äº›å»ºè­°å—ï¼Ÿ";

          // éš±è—çµæœ
          document.getElementById("readingTextResult").style.display = "none";
          document.getElementById("uploadResult").innerHTML = "";
          document.getElementById("testResult").innerHTML = "";
          document.getElementById("aiResult").innerHTML = "";

          // é‡ç½®æŒ‰éˆ•ç‹€æ…‹
          document.getElementById("uploadBtn").disabled = true;
          document.getElementById("testBtn").disabled = true;
          document.getElementById("aiBtn").disabled = true;

          // é‡ç½®æ­¥é©Ÿç‹€æ…‹
          document.querySelectorAll(".step").forEach((step) => {
            step.classList.remove("active", "completed");
          });
          document.getElementById("step1").classList.add("active");

          // é‡ç½®é€²åº¦æŒ‡ç¤ºå™¨
          updateProgress(1);

          // æ¸…é™¤æœ¬åœ°å­˜å„²
          localStorage.removeItem("voiceCloneProgress");

          showToast("å·²é‡ç½®æ‰€æœ‰æ•¸æ“š", "info");
        }
      }

      // åœ¨é—œéµæ“ä½œå¾Œä¿å­˜é€²åº¦
      function nextStep(step) {
        // æ›´æ–°æ­¥é©Ÿç‹€æ…‹
        document
          .getElementById(`step${currentStep}`)
          .classList.remove("active");
        document
          .getElementById(`step${currentStep}`)
          .classList.add("completed");
        document.getElementById(`step${step}`).classList.add("active");

        // æ›´æ–°é€²åº¦æŒ‡ç¤ºå™¨
        updateProgress(step);

        currentStep = step;

        // ä¿å­˜é€²åº¦
        saveProgress();

        // å¹³æ»‘æ»¾å‹•åˆ°æ–°æ­¥é©Ÿ
        document.getElementById(`step${step}`).scrollIntoView({
          behavior: "smooth",
          block: "center",
        });

        showToast(`å·²é€²å…¥æ­¥é©Ÿ ${step}`, "info");
      }
    </script>
  </body>
</html>
